#ifndef TEST_BILINEAR_FORM_ANALYTIC_BOUNDARY_INTEGRAL
#define TEST_BILINEAR_FORM_ANALYTIC_BOUNDARY_INTEGRAL

// @HEADER
//
// Copyright Â© 2011 Sandia Corporation. All Rights Reserved.
//
// Redistribution and use in source and binary forms, with or without modification, are 
// permitted provided that the following conditions are met:
// 1. Redistributions of source code must retain the above copyright notice, this list of 
// conditions and the following disclaimer.
// 2. Redistributions in binary form must reproduce the above copyright notice, this list of 
// conditions and the following disclaimer in the documentation and/or other materials 
// provided with the distribution.
// 3. The name of the author may not be used to endorse or promote products derived from 
// this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY SANDIA CORPORATION "AS IS" AND ANY 
// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR 
// PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR 
// ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR 
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT 
// OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR 
// BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF 
// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING 
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
// Questions? Contact Nate Roberts (nate@nateroberts.com).
//
// @HEADER 

/*
 *  TestBilinearFormAnalyticBoundaryIntegral.h
 *
 *
 */


#include "Intrepid_FieldContainer.hpp"

#include "BilinearForm.h"

/*
 This test bilinear form just has b(u,v) = Int_dK (u_hat, grad v \cdot n),
 where u_hat is a trace (belongs formally to H^(1/2)), and v is a test
 function, belonging to H(grad,K).
 
 Some explicit values have been computed using Mathematica for
 cubic shape functions on the quad, and these are included in the expected*() methods
 below.  (Two variants for each: one for "conforming" traces, which means
 that the edge values are constrained to agree where they meet at a vertex,
 and non-conforming, which means that there is no such constraint imposed...
 */

using namespace Intrepid;

class TestBilinearFormAnalyticBoundaryIntegral : public BilinearForm {
private:
  static const string & S_TEST;
  static const string & S_TRIAL;
  
public:
  TestBilinearFormAnalyticBoundaryIntegral() {
    _testIDs.push_back(0);
    _trialIDs.push_back(0);
  }
  
  // implement the virtual methods declared in super:
  const string & testName(int testID) {
    return S_TEST;
  }
  const string & trialName(int trialID) {
    return S_TRIAL;
  }
  
  bool trialTestOperator(int trialID, int testID, 
                         EOperatorExtended &trialOperator, EOperatorExtended &testOperator) {
    trialOperator = IntrepidExtendedTypes::OPERATOR_TIMES_NORMAL;
    testOperator  = IntrepidExtendedTypes::OPERATOR_GRAD;
    return true;
  }
  
  void applyBilinearFormData(int trialID, int testID,
                           FieldContainer<double> &trialValues, FieldContainer<double> &testValues,  
                           const FieldContainer<double> &points) {
    // leave values as they are...             
  }
  
  EFunctionSpaceExtended functionSpaceForTest(int testID) {
    return IntrepidExtendedTypes::FUNCTION_SPACE_HGRAD;
  }
  
  EFunctionSpaceExtended functionSpaceForTrial(int trialID) {
    return IntrepidExtendedTypes::FUNCTION_SPACE_HGRAD;
  }
  
  bool isFluxOrTrace(int trialID) {
    return true;
  }
  
  static void expectedPreStiffnessForCubicsOnQuad(FieldContainer<double> &stiffnessExpected, bool conformingTraces) {
    if (! conformingTraces) {
      stiffnessExpected.resize(1,16,16);
      stiffnessExpected(0,0,0) = 0.42857142857142905;
      stiffnessExpected(0,0,1) = 0.15971914124998537;
      stiffnessExpected(0,0,2) = -0.15971914124998543;
      stiffnessExpected(0,0,3) = 0.07142857142857155;
      stiffnessExpected(0,1,0) = 0.15971914124998537;
      stiffnessExpected(0,1,1) = 2.142857142857146;
      stiffnessExpected(0,1,2) = 0.3571428571428592;
      stiffnessExpected(0,1,3) = -0.15971914124998565;
      stiffnessExpected(0,2,0) = -0.15971914124998543;
      stiffnessExpected(0,2,1) = 0.3571428571428592;
      stiffnessExpected(0,2,2) = 2.1428571428571423;
      stiffnessExpected(0,2,3) = 0.15971914124998401;
      stiffnessExpected(0,3,0) = 0.07142857142857155;
      stiffnessExpected(0,3,1) = -0.15971914124998565;
      stiffnessExpected(0,3,2) = 0.15971914124998401;
      stiffnessExpected(0,3,3) = 0.4285714285714284;
      stiffnessExpected(0,4,0) = -0.5778692816963917;
      stiffnessExpected(0,4,1) = -0.21535916599701813;
      stiffnessExpected(0,4,2) = 0.21535916599701815;
      stiffnessExpected(0,4,3) = -0.09631154694939868;
      stiffnessExpected(0,5,0) = -0.21535916599701785;
      stiffnessExpected(0,5,1) = -2.889346408481959;
      stiffnessExpected(0,5,2) = -0.4815577347469978;
      stiffnessExpected(0,5,3) = 0.21535916599701815;
      stiffnessExpected(0,6,0) = 0.21535916599701813;
      stiffnessExpected(0,6,1) = -0.4815577347469955;
      stiffnessExpected(0,6,2) = -2.8893464084819542;
      stiffnessExpected(0,6,3) = -0.2153591659970163;
      stiffnessExpected(0,7,0) = -0.09631154694939867;
      stiffnessExpected(0,7,1) = 0.21535916599701843;
      stiffnessExpected(0,7,2) = -0.21535916599701632;
      stiffnessExpected(0,7,3) = -0.5778692816963908;
      stiffnessExpected(0,8,0) = 0.2207264245535342;
      stiffnessExpected(0,8,1) = 0.08225988162203032;
      stiffnessExpected(0,8,2) = -0.08225988162203032;
      stiffnessExpected(0,8,3) = 0.036787737425589065;
      stiffnessExpected(0,9,0) = 0.08225988162203018;
      stiffnessExpected(0,9,1) = 1.1036321227676709;
      stiffnessExpected(0,9,2) = 0.18393868712794692;
      stiffnessExpected(0,9,3) = -0.0822598816220303;
      stiffnessExpected(0,10,0) = -0.08225988162203035;
      stiffnessExpected(0,10,1) = 0.18393868712794603;
      stiffnessExpected(0,10,2) = 1.1036321227676695;
      stiffnessExpected(0,10,3) = 0.08225988162202963;
      stiffnessExpected(0,11,0) = 0.03678773742558904;
      stiffnessExpected(0,11,1) = -0.08225988162203043;
      stiffnessExpected(0,11,2) = 0.0822598816220296;
      stiffnessExpected(0,11,3) = 0.22072642455353386;
      stiffnessExpected(0,12,0) = -0.07142857142857134;
      stiffnessExpected(0,12,1) = -0.026619856874997516;
      stiffnessExpected(0,12,2) = 0.026619856874997544;
      stiffnessExpected(0,12,3) = -0.01190476190476187;
      stiffnessExpected(0,13,0) = -0.026619856874997516;
      stiffnessExpected(0,13,1) = -0.35714285714285743;
      stiffnessExpected(0,13,2) = -0.059523809523810145;
      stiffnessExpected(0,13,3) = 0.026619856874997558;
      stiffnessExpected(0,14,0) = 0.026619856874997516;
      stiffnessExpected(0,14,1) = -0.05952380952380984;
      stiffnessExpected(0,14,2) = -0.35714285714285665;
      stiffnessExpected(0,14,3) = -0.026619856874997322;
      stiffnessExpected(0,15,0) = -0.01190476190476187;
      stiffnessExpected(0,15,1) = 0.0266198568749976;
      stiffnessExpected(0,15,2) = -0.026619856874997405;
      stiffnessExpected(0,15,3) = -0.07142857142857134;
      stiffnessExpected(0,0,4) = -0.07142857142857154;
      stiffnessExpected(0,0,5) = -0.026619856874997558;
      stiffnessExpected(0,0,6) = 0.026619856874997613;
      stiffnessExpected(0,0,7) = -0.011904761904761911;
      stiffnessExpected(0,1,4) = 0.22072642455353397;
      stiffnessExpected(0,1,5) = 0.08225988162202993;
      stiffnessExpected(0,1,6) = -0.08225988162202977;
      stiffnessExpected(0,1,7) = 0.03678773742558901;
      stiffnessExpected(0,2,4) = -0.5778692816963915;
      stiffnessExpected(0,2,5) = -0.21535916599701788;
      stiffnessExpected(0,2,6) = 0.2153591659970184;
      stiffnessExpected(0,2,7) = -0.0963115469493985;
      stiffnessExpected(0,3,4) = 0.4285714285714284;
      stiffnessExpected(0,3,5) = 0.1597191412499878;
      stiffnessExpected(0,3,6) = -0.15971914124998524;
      stiffnessExpected(0,3,7) = 0.07142857142857119;
      stiffnessExpected(0,4,4) = -0.026619856874997558;
      stiffnessExpected(0,4,5) = -0.3571428571428579;
      stiffnessExpected(0,4,6) = -0.05952380952380973;
      stiffnessExpected(0,4,7) = 0.026619856874997613;
      stiffnessExpected(0,5,4) = 0.08225988162203152;
      stiffnessExpected(0,5,5) = 1.1036321227676713;
      stiffnessExpected(0,5,6) = 0.1839386871279478;
      stiffnessExpected(0,5,7) = -0.0822598816220321;
      stiffnessExpected(0,6,4) = -0.21535916599701826;
      stiffnessExpected(0,6,5) = -2.8893464084819582;
      stiffnessExpected(0,6,6) = -0.48155773474699204;
      stiffnessExpected(0,6,7) = 0.21535916599701915;
      stiffnessExpected(0,7,4) = 0.15971914124998549;
      stiffnessExpected(0,7,5) = 2.142857142857146;
      stiffnessExpected(0,7,6) = 0.35714285714285754;
      stiffnessExpected(0,7,7) = -0.15971914124998537;
      stiffnessExpected(0,8,4) = 0.026619856874997613;
      stiffnessExpected(0,8,5) = -0.05952380952380973;
      stiffnessExpected(0,8,6) = -0.3571428571428572;
      stiffnessExpected(0,8,7) = -0.026619856874997405;
      stiffnessExpected(0,9,4) = -0.0822598816220291;
      stiffnessExpected(0,9,5) = 0.18393868712794575;
      stiffnessExpected(0,9,6) = 1.1036321227676689;
      stiffnessExpected(0,9,7) = 0.0822598816220299;
      stiffnessExpected(0,10,4) = 0.2153591659970185;
      stiffnessExpected(0,10,5) = -0.48155773474699404;
      stiffnessExpected(0,10,6) = -2.8893464084819542;
      stiffnessExpected(0,10,7) = -0.21535916599701674;
      stiffnessExpected(0,11,4) = -0.1597191412499851;
      stiffnessExpected(0,11,5) = 0.3571428571428582;
      stiffnessExpected(0,11,6) = 2.142857142857142;
      stiffnessExpected(0,11,7) = 0.1597191412499841;
      stiffnessExpected(0,12,4) = -0.011904761904761911;
      stiffnessExpected(0,12,5) = 0.026619856874997613;
      stiffnessExpected(0,12,6) = -0.026619856874997405;
      stiffnessExpected(0,12,7) = -0.07142857142857145;
      stiffnessExpected(0,13,4) = 0.03678773742558905;
      stiffnessExpected(0,13,5) = -0.08225988162203016;
      stiffnessExpected(0,13,6) = 0.08225988162203579;
      stiffnessExpected(0,13,7) = 0.22072642455353375;
      stiffnessExpected(0,14,4) = -0.09631154694939784;
      stiffnessExpected(0,14,5) = 0.21535916599701943;
      stiffnessExpected(0,14,6) = -0.21535916599701654;
      stiffnessExpected(0,14,7) = -0.5778692816963912;
      stiffnessExpected(0,15,4) = 0.07142857142857145;
      stiffnessExpected(0,15,5) = -0.15971914124998565;
      stiffnessExpected(0,15,6) = 0.15971914124998438;
      stiffnessExpected(0,15,7) = 0.42857142857142844;
      stiffnessExpected(0,0,8) = -0.011904761904761925;
      stiffnessExpected(0,0,9) = 0.02661985687499757;
      stiffnessExpected(0,0,10) = -0.02661985687499757;
      stiffnessExpected(0,0,11) = -0.07142857142857154;
      stiffnessExpected(0,1,8) = 0.026619856874997613;
      stiffnessExpected(0,1,9) = -0.059523809523809895;
      stiffnessExpected(0,1,10) = -0.3571428571428579;
      stiffnessExpected(0,1,11) = -0.02661985687499757;
      stiffnessExpected(0,2,8) = -0.02661985687499735;
      stiffnessExpected(0,2,9) = -0.3571428571428572;
      stiffnessExpected(0,2,10) = -0.059523809523809895;
      stiffnessExpected(0,2,11) = 0.02661985687499757;
      stiffnessExpected(0,3,8) = -0.07142857142857145;
      stiffnessExpected(0,3,9) = -0.02661985687499735;
      stiffnessExpected(0,3,10) = 0.026619856874997613;
      stiffnessExpected(0,3,11) = -0.011904761904761925;
      stiffnessExpected(0,4,8) = 0.03678773742558902;
      stiffnessExpected(0,4,9) = -0.08225988162203027;
      stiffnessExpected(0,4,10) = 0.08225988162203024;
      stiffnessExpected(0,4,11) = 0.22072642455353397;
      stiffnessExpected(0,5,8) = -0.08225988162203024;
      stiffnessExpected(0,5,9) = 0.1839386871279468;
      stiffnessExpected(0,5,10) = 1.1036321227676702;
      stiffnessExpected(0,5,11) = 0.08225988162202988;
      stiffnessExpected(0,6,8) = 0.08225988162202952;
      stiffnessExpected(0,6,9) = 1.1036321227676682;
      stiffnessExpected(0,6,10) = 0.18393868712794587;
      stiffnessExpected(0,6,11) = -0.08225988162203024;
      stiffnessExpected(0,7,8) = 0.22072642455353364;
      stiffnessExpected(0,7,9) = 0.08225988162202955;
      stiffnessExpected(0,7,10) = -0.08225988162203038;
      stiffnessExpected(0,7,11) = 0.03678773742558902;
      stiffnessExpected(0,8,8) = -0.09631154694939867;
      stiffnessExpected(0,8,9) = 0.21535916599701815;
      stiffnessExpected(0,8,10) = -0.2153591659970181;
      stiffnessExpected(0,8,11) = -0.5778692816963916;
      stiffnessExpected(0,9,8) = 0.21535916599701815;
      stiffnessExpected(0,9,9) = -0.4815577347469979;
      stiffnessExpected(0,9,10) = -2.889346408481959;
      stiffnessExpected(0,9,11) = -0.21535916599701788;
      stiffnessExpected(0,10,8) = -0.21535916599701632;
      stiffnessExpected(0,10,9) = -2.8893464084819547;
      stiffnessExpected(0,10,10) = -0.4815577347469954;
      stiffnessExpected(0,10,11) = 0.2153591659970182;
      stiffnessExpected(0,11,8) = -0.5778692816963907;
      stiffnessExpected(0,11,9) = -0.2153591659970163;
      stiffnessExpected(0,11,10) = 0.21535916599701843;
      stiffnessExpected(0,11,11) = -0.09631154694939867;
      stiffnessExpected(0,12,8) = 0.07142857142857154;
      stiffnessExpected(0,12,9) = -0.15971914124998526;
      stiffnessExpected(0,12,10) = 0.15971914124998543;
      stiffnessExpected(0,12,11) = 0.42857142857142916;
      stiffnessExpected(0,13,8) = -0.15971914124998543;
      stiffnessExpected(0,13,9) = 0.35714285714286115;
      stiffnessExpected(0,13,10) = 2.142857142857146;
      stiffnessExpected(0,13,11) = 0.15971914124998524;
      stiffnessExpected(0,14,8) = 0.15971914124998435;
      stiffnessExpected(0,14,9) = 2.1428571428571423;
      stiffnessExpected(0,14,10) = 0.3571428571428592;
      stiffnessExpected(0,14,11) = -0.15971914124998557;
      stiffnessExpected(0,15,8) = 0.42857142857142844;
      stiffnessExpected(0,15,9) = 0.15971914124998404;
      stiffnessExpected(0,15,10) = -0.15971914124998565;
      stiffnessExpected(0,15,11) = 0.07142857142857155;
      stiffnessExpected(0,0,12) = 0.07142857142857145;
      stiffnessExpected(0,0,13) = -0.15971914124998565;
      stiffnessExpected(0,0,14) = 0.15971914124998524;
      stiffnessExpected(0,0,15) = 0.42857142857142894;
      stiffnessExpected(0,1,12) = -0.09631154694939864;
      stiffnessExpected(0,1,13) = 0.21535916599701688;
      stiffnessExpected(0,1,14) = -0.21535916599701727;
      stiffnessExpected(0,1,15) = -0.5778692816963916;
      stiffnessExpected(0,2,12) = 0.036787737425588996;
      stiffnessExpected(0,2,13) = -0.0822598816220304;
      stiffnessExpected(0,2,14) = 0.08225988162203021;
      stiffnessExpected(0,2,15) = 0.22072642455353408;
      stiffnessExpected(0,3,12) = -0.011904761904761654;
      stiffnessExpected(0,3,13) = 0.026619856874998557;
      stiffnessExpected(0,3,14) = -0.026619856874997766;
      stiffnessExpected(0,3,15) = -0.07142857142857106;
      stiffnessExpected(0,4,12) = -0.15971914124998565;
      stiffnessExpected(0,4,13) = 0.3571428571428582;
      stiffnessExpected(0,4,14) = 2.142857142857146;
      stiffnessExpected(0,4,15) = 0.15971914124998524;
      stiffnessExpected(0,5,12) = 0.21535916599701738;
      stiffnessExpected(0,5,13) = -0.4815577347469944;
      stiffnessExpected(0,5,14) = -2.8893464084819587;
      stiffnessExpected(0,5,15) = -0.215359165997018;
      stiffnessExpected(0,6,12) = -0.08225988162203077;
      stiffnessExpected(0,6,13) = 0.1839386871279436;
      stiffnessExpected(0,6,14) = 1.10363212276767;
      stiffnessExpected(0,6,15) = 0.08225988162203077;
      stiffnessExpected(0,7,12) = 0.026619856874997377;
      stiffnessExpected(0,7,13) = -0.05952380952380973;
      stiffnessExpected(0,7,14) = -0.35714285714285743;
      stiffnessExpected(0,7,15) = -0.026619856874997253;
      stiffnessExpected(0,8,12) = 0.15971914124998435;
      stiffnessExpected(0,8,13) = 2.142857142857142;
      stiffnessExpected(0,8,14) = 0.3571428571428582;
      stiffnessExpected(0,8,15) = -0.15971914124998565;
      stiffnessExpected(0,9,12) = -0.2153591659970172;
      stiffnessExpected(0,9,13) = -2.889346408481954;
      stiffnessExpected(0,9,14) = -0.4815577347469927;
      stiffnessExpected(0,9,15) = 0.21535916599701882;
      stiffnessExpected(0,10,12) = 0.0822598816220298;
      stiffnessExpected(0,10,13) = 1.1036321227676695;
      stiffnessExpected(0,10,14) = 0.1839386871279456;
      stiffnessExpected(0,10,15) = -0.08225988162203043;
      stiffnessExpected(0,11,12) = -0.02661985687499746;
      stiffnessExpected(0,11,13) = -0.35714285714285665;
      stiffnessExpected(0,11,14) = -0.059523809523809645;
      stiffnessExpected(0,11,15) = 0.026619856874998377;
      stiffnessExpected(0,12,12) = 0.4285714285714284;
      stiffnessExpected(0,12,13) = 0.15971914124998435;
      stiffnessExpected(0,12,14) = -0.15971914124998565;
      stiffnessExpected(0,12,15) = 0.07142857142857145;
      stiffnessExpected(0,13,12) = -0.5778692816963913;
      stiffnessExpected(0,13,13) = -0.21535916599701732;
      stiffnessExpected(0,13,14) = 0.21535916599701843;
      stiffnessExpected(0,13,15) = -0.09631154694939861;
      stiffnessExpected(0,14,12) = 0.22072642455353342;
      stiffnessExpected(0,14,13) = 0.08225988162202927;
      stiffnessExpected(0,14,14) = -0.0822598816220298;
      stiffnessExpected(0,14,15) = 0.03678773742558884;
      stiffnessExpected(0,15,12) = -0.07142857142857134;
      stiffnessExpected(0,15,13) = -0.026619856874997377;
      stiffnessExpected(0,15,14) = 0.026619856874997586;
      stiffnessExpected(0,15,15) = -0.011904761904761897;
    } else {
      stiffnessExpected.resize(1,16,12);
      stiffnessExpected(0,0,0) = 0.857142857142858;
      stiffnessExpected(0,0,1) = 0.15971914124998537;
      stiffnessExpected(0,0,2) = -0.15971914124998543;
      stiffnessExpected(0,0,3) = 1.3877787807814457e-17;
      stiffnessExpected(0,0,4) = -0.026619856874997558;
      stiffnessExpected(0,0,5) = 0.026619856874997613;
      stiffnessExpected(0,0,6) = -0.023809523809523836;
      stiffnessExpected(0,0,7) = 0.02661985687499757;
      stiffnessExpected(0,0,8) = -0.02661985687499757;
      stiffnessExpected(0,0,9) = -8.326672684688674e-17;
      stiffnessExpected(0,0,10) = -0.15971914124998565;
      stiffnessExpected(0,0,11) = 0.15971914124998524;
      stiffnessExpected(0,1,0) = -0.41815014044640625;
      stiffnessExpected(0,1,1) = 2.142857142857146;
      stiffnessExpected(0,1,2) = 0.3571428571428592;
      stiffnessExpected(0,1,3) = 0.06100728330354832;
      stiffnessExpected(0,1,4) = 0.08225988162202993;
      stiffnessExpected(0,1,5) = -0.08225988162202977;
      stiffnessExpected(0,1,6) = 0.06340759430058662;
      stiffnessExpected(0,1,7) = -0.059523809523809895;
      stiffnessExpected(0,1,8) = -0.3571428571428579;
      stiffnessExpected(0,1,9) = -0.12293140382439621;
      stiffnessExpected(0,1,10) = 0.21535916599701688;
      stiffnessExpected(0,1,11) = -0.21535916599701727;
      stiffnessExpected(0,2,0) = 0.061007283303548654;
      stiffnessExpected(0,2,1) = 0.3571428571428592;
      stiffnessExpected(0,2,2) = 2.1428571428571423;
      stiffnessExpected(0,2,3) = -0.4181501404464075;
      stiffnessExpected(0,2,4) = -0.21535916599701788;
      stiffnessExpected(0,2,5) = 0.2153591659970184;
      stiffnessExpected(0,2,6) = -0.12293140382439585;
      stiffnessExpected(0,2,7) = -0.3571428571428572;
      stiffnessExpected(0,2,8) = -0.059523809523809895;
      stiffnessExpected(0,2,9) = 0.06340759430058657;
      stiffnessExpected(0,2,10) = -0.0822598816220304;
      stiffnessExpected(0,2,11) = 0.08225988162203021;
      stiffnessExpected(0,3,0) = 4.85722573273506e-16;
      stiffnessExpected(0,3,1) = -0.15971914124998565;
      stiffnessExpected(0,3,2) = 0.15971914124998401;
      stiffnessExpected(0,3,3) = 0.8571428571428568;
      stiffnessExpected(0,3,4) = 0.1597191412499878;
      stiffnessExpected(0,3,5) = -0.15971914124998524;
      stiffnessExpected(0,3,6) = -2.636779683484747e-16;
      stiffnessExpected(0,3,7) = -0.02661985687499735;
      stiffnessExpected(0,3,8) = 0.026619856874997613;
      stiffnessExpected(0,3,9) = -0.02380952380952358;
      stiffnessExpected(0,3,10) = 0.026619856874998557;
      stiffnessExpected(0,3,11) = -0.026619856874997766;
      stiffnessExpected(0,4,0) = -0.4181501404464065;
      stiffnessExpected(0,4,1) = -0.21535916599701813;
      stiffnessExpected(0,4,2) = 0.21535916599701815;
      stiffnessExpected(0,4,3) = -0.12293140382439624;
      stiffnessExpected(0,4,4) = -0.3571428571428579;
      stiffnessExpected(0,4,5) = -0.05952380952380973;
      stiffnessExpected(0,4,6) = 0.06340759430058664;
      stiffnessExpected(0,4,7) = -0.08225988162203027;
      stiffnessExpected(0,4,8) = 0.08225988162203024;
      stiffnessExpected(0,4,9) = 0.06100728330354832;
      stiffnessExpected(0,4,10) = 0.3571428571428582;
      stiffnessExpected(0,4,11) = 2.142857142857146;
      stiffnessExpected(0,5,0) = -0.43071833199403586;
      stiffnessExpected(0,5,1) = -2.889346408481959;
      stiffnessExpected(0,5,2) = -0.4815577347469978;
      stiffnessExpected(0,5,3) = 0.29761904761904967;
      stiffnessExpected(0,5,4) = 1.1036321227676713;
      stiffnessExpected(0,5,5) = 0.1839386871279478;
      stiffnessExpected(0,5,6) = -0.16451976324406234;
      stiffnessExpected(0,5,7) = 0.1839386871279468;
      stiffnessExpected(0,5,8) = 1.1036321227676702;
      stiffnessExpected(0,5,9) = 0.29761904761904723;
      stiffnessExpected(0,5,10) = -0.4815577347469944;
      stiffnessExpected(0,5,11) = -2.8893464084819587;
      stiffnessExpected(0,6,0) = 0.2976190476190489;
      stiffnessExpected(0,6,1) = -0.4815577347469955;
      stiffnessExpected(0,6,2) = -2.8893464084819542;
      stiffnessExpected(0,6,3) = -0.43071833199403453;
      stiffnessExpected(0,6,4) = -2.8893464084819582;
      stiffnessExpected(0,6,5) = -0.48155773474699204;
      stiffnessExpected(0,6,6) = 0.29761904761904867;
      stiffnessExpected(0,6,7) = 1.1036321227676682;
      stiffnessExpected(0,6,8) = 0.18393868712794587;
      stiffnessExpected(0,6,9) = -0.164519763244061;
      stiffnessExpected(0,6,10) = 0.1839386871279436;
      stiffnessExpected(0,6,11) = 1.10363212276767;
      stiffnessExpected(0,7,0) = -0.12293140382439592;
      stiffnessExpected(0,7,1) = 0.21535916599701843;
      stiffnessExpected(0,7,2) = -0.21535916599701632;
      stiffnessExpected(0,7,3) = -0.41815014044640536;
      stiffnessExpected(0,7,4) = 2.142857142857146;
      stiffnessExpected(0,7,5) = 0.35714285714285754;
      stiffnessExpected(0,7,6) = 0.061007283303548265;
      stiffnessExpected(0,7,7) = 0.08225988162202955;
      stiffnessExpected(0,7,8) = -0.08225988162203038;
      stiffnessExpected(0,7,9) = 0.0634075943005864;
      stiffnessExpected(0,7,10) = -0.05952380952380973;
      stiffnessExpected(0,7,11) = -0.35714285714285743;
      stiffnessExpected(0,8,0) = 0.06100728330354854;
      stiffnessExpected(0,8,1) = 0.08225988162203032;
      stiffnessExpected(0,8,2) = -0.08225988162203032;
      stiffnessExpected(0,8,3) = 0.06340759430058668;
      stiffnessExpected(0,8,4) = -0.05952380952380973;
      stiffnessExpected(0,8,5) = -0.3571428571428572;
      stiffnessExpected(0,8,6) = -0.12293140382439607;
      stiffnessExpected(0,8,7) = 0.21535916599701815;
      stiffnessExpected(0,8,8) = -0.2153591659970181;
      stiffnessExpected(0,8,9) = -0.4181501404464073;
      stiffnessExpected(0,8,10) = 2.142857142857142;
      stiffnessExpected(0,8,11) = 0.3571428571428582;
      stiffnessExpected(0,9,0) = 0.297619047619049;
      stiffnessExpected(0,9,1) = 1.1036321227676709;
      stiffnessExpected(0,9,2) = 0.18393868712794692;
      stiffnessExpected(0,9,3) = -0.1645197632440594;
      stiffnessExpected(0,9,4) = 0.18393868712794575;
      stiffnessExpected(0,9,5) = 1.1036321227676689;
      stiffnessExpected(0,9,6) = 0.29761904761904806;
      stiffnessExpected(0,9,7) = -0.4815577347469979;
      stiffnessExpected(0,9,8) = -2.889346408481959;
      stiffnessExpected(0,9,9) = -0.4307183319940351;
      stiffnessExpected(0,9,10) = -2.889346408481954;
      stiffnessExpected(0,9,11) = -0.4815577347469927;
      stiffnessExpected(0,10,0) = -0.16451976324406078;
      stiffnessExpected(0,10,1) = 0.18393868712794603;
      stiffnessExpected(0,10,2) = 1.1036321227676695;
      stiffnessExpected(0,10,3) = 0.2976190476190481;
      stiffnessExpected(0,10,4) = -0.48155773474699404;
      stiffnessExpected(0,10,5) = -2.8893464084819542;
      stiffnessExpected(0,10,6) = -0.4307183319940331;
      stiffnessExpected(0,10,7) = -2.8893464084819547;
      stiffnessExpected(0,10,8) = -0.4815577347469954;
      stiffnessExpected(0,10,9) = 0.297619047619048;
      stiffnessExpected(0,10,10) = 1.1036321227676695;
      stiffnessExpected(0,10,11) = 0.1839386871279456;
      stiffnessExpected(0,11,0) = 0.06340759430058741;
      stiffnessExpected(0,11,1) = -0.08225988162203043;
      stiffnessExpected(0,11,2) = 0.0822598816220296;
      stiffnessExpected(0,11,3) = 0.061007283303548765;
      stiffnessExpected(0,11,4) = 0.3571428571428582;
      stiffnessExpected(0,11,5) = 2.142857142857142;
      stiffnessExpected(0,11,6) = -0.41815014044640664;
      stiffnessExpected(0,11,7) = -0.2153591659970163;
      stiffnessExpected(0,11,8) = 0.21535916599701843;
      stiffnessExpected(0,11,9) = -0.12293140382439613;
      stiffnessExpected(0,11,10) = -0.35714285714285665;
      stiffnessExpected(0,11,11) = -0.059523809523809645;
      stiffnessExpected(0,12,0) = 1.1102230246251565e-16;
      stiffnessExpected(0,12,1) = -0.026619856874997516;
      stiffnessExpected(0,12,2) = 0.026619856874997544;
      stiffnessExpected(0,12,3) = -0.02380952380952378;
      stiffnessExpected(0,12,4) = 0.026619856874997613;
      stiffnessExpected(0,12,5) = -0.026619856874997405;
      stiffnessExpected(0,12,6) = 8.326672684688674e-17;
      stiffnessExpected(0,12,7) = -0.15971914124998526;
      stiffnessExpected(0,12,8) = 0.15971914124998543;
      stiffnessExpected(0,12,9) = 0.8571428571428575;
      stiffnessExpected(0,12,10) = 0.15971914124998435;
      stiffnessExpected(0,12,11) = -0.15971914124998565;
      stiffnessExpected(0,13,0) = -0.12293140382439613;
      stiffnessExpected(0,13,1) = -0.35714285714285743;
      stiffnessExpected(0,13,2) = -0.059523809523810145;
      stiffnessExpected(0,13,3) = 0.06340759430058661;
      stiffnessExpected(0,13,4) = -0.08225988162203016;
      stiffnessExpected(0,13,5) = 0.08225988162203579;
      stiffnessExpected(0,13,6) = 0.06100728330354832;
      stiffnessExpected(0,13,7) = 0.35714285714286115;
      stiffnessExpected(0,13,8) = 2.142857142857146;
      stiffnessExpected(0,13,9) = -0.4181501404464061;
      stiffnessExpected(0,13,10) = -0.21535916599701732;
      stiffnessExpected(0,13,11) = 0.21535916599701843;
      stiffnessExpected(0,14,0) = 0.06340759430058636;
      stiffnessExpected(0,14,1) = -0.05952380952380984;
      stiffnessExpected(0,14,2) = -0.35714285714285665;
      stiffnessExpected(0,14,3) = -0.12293140382439516;
      stiffnessExpected(0,14,4) = 0.21535916599701943;
      stiffnessExpected(0,14,5) = -0.21535916599701654;
      stiffnessExpected(0,14,6) = -0.41815014044640686;
      stiffnessExpected(0,14,7) = 2.1428571428571423;
      stiffnessExpected(0,14,8) = 0.3571428571428592;
      stiffnessExpected(0,14,9) = 0.06100728330354785;
      stiffnessExpected(0,14,10) = 0.08225988162202927;
      stiffnessExpected(0,14,11) = -0.0822598816220298;
      stiffnessExpected(0,15,0) = -0.023809523809523767;
      stiffnessExpected(0,15,1) = 0.0266198568749976;
      stiffnessExpected(0,15,2) = -0.026619856874997405;
      stiffnessExpected(0,15,3) = 1.1102230246251565e-16;
      stiffnessExpected(0,15,4) = -0.15971914124998565;
      stiffnessExpected(0,15,5) = 0.15971914124998438;
      stiffnessExpected(0,15,6) = 0.8571428571428569;
      stiffnessExpected(0,15,7) = 0.15971914124998404;
      stiffnessExpected(0,15,8) = -0.15971914124998565;
      stiffnessExpected(0,15,9) = 2.0816681711721685e-16;
      stiffnessExpected(0,15,10) = -0.026619856874997377;
      stiffnessExpected(0,15,11) = 0.026619856874997586;
    }
  }
  
  static void expectedIPMatrixForCubicsOnQuad(FieldContainer<double> &ipMatrixExpected) {
    ipMatrixExpected.resize(1,16,16);
    ipMatrixExpected(0,0,0) = 0.6394557823129254;
    ipMatrixExpected(0,1,0) = -0.2255000638541592;
    ipMatrixExpected(0,2,0) = -0.07211898376488793;
    ipMatrixExpected(0,3,0) = 0.04308390022675741;
    ipMatrixExpected(0,4,0) = -0.22550006385415977;
    ipMatrixExpected(0,5,0) = -0.25689112700183325;
    ipMatrixExpected(0,6,0) = 0.14597505668934127;
    ipMatrixExpected(0,7,0) = -0.06124543897569006;
    ipMatrixExpected(0,8,0) = -0.07211898376488846;
    ipMatrixExpected(0,9,0) = 0.14597505668934174;
    ipMatrixExpected(0,10,0) = -0.03505898637685316;
    ipMatrixExpected(0,11,0) = 0.011642264372517502;
    ipMatrixExpected(0,12,0) = 0.04308390022675734;
    ipMatrixExpected(0,13,0) = -0.06124543897569068;
    ipMatrixExpected(0,14,0) = 0.011642264372517065;
    ipMatrixExpected(0,15,0) = -0.003401360544217533;
    ipMatrixExpected(0,0,1) = -0.2255000638541592;
    ipMatrixExpected(0,1,1) = 2.2448979591836764;
    ipMatrixExpected(0,2,1) = -0.02267573696145056;
    ipMatrixExpected(0,3,1) = -0.0721189837648888;
    ipMatrixExpected(0,4,1) = -0.25689112700183325;
    ipMatrixExpected(0,5,1) = -1.4824317442707629;
    ipMatrixExpected(0,6,1) = -0.39496005112844845;
    ipMatrixExpected(0,7,1) = 0.1459750566893411;
    ipMatrixExpected(0,8,1) = 0.14597505668934063;
    ipMatrixExpected(0,9,1) = -0.005663493824473509;
    ipMatrixExpected(0,10,1) = 0.1469441781125666;
    ipMatrixExpected(0,11,1) = -0.03505898637685291;
    ipMatrixExpected(0,12,1) = -0.06124543897569151;
    ipMatrixExpected(0,13,1) = 0.05668934240362877;
    ipMatrixExpected(0,14,1) = -0.056689342403626525;
    ipMatrixExpected(0,15,1) = 0.011642264372516295;
    ipMatrixExpected(0,0,2) = -0.07211898376488793;
    ipMatrixExpected(0,1,2) = -0.02267573696145056;
    ipMatrixExpected(0,2,2) = 2.2448979591836737;
    ipMatrixExpected(0,3,2) = -0.22550006385415905;
    ipMatrixExpected(0,4,2) = 0.1459750566893433;
    ipMatrixExpected(0,5,2) = -0.39496005112845367;
    ipMatrixExpected(0,6,2) = -1.482431744270763;
    ipMatrixExpected(0,7,2) = -0.2568911270018305;
    ipMatrixExpected(0,8,2) = -0.03505898637685309;
    ipMatrixExpected(0,9,2) = 0.146944178112573;
    ipMatrixExpected(0,10,2) = -0.005663493824473287;
    ipMatrixExpected(0,11,2) = 0.1459750566893434;
    ipMatrixExpected(0,12,2) = 0.01164226437251712;
    ipMatrixExpected(0,13,2) = -0.05668934240362705;
    ipMatrixExpected(0,14,2) = 0.05668934240362833;
    ipMatrixExpected(0,15,2) = -0.06124543897569129;
    ipMatrixExpected(0,0,3) = 0.04308390022675741;
    ipMatrixExpected(0,1,3) = -0.0721189837648888;
    ipMatrixExpected(0,2,3) = -0.22550006385415905;
    ipMatrixExpected(0,3,3) = 0.6394557823129253;
    ipMatrixExpected(0,4,3) = -0.06124543897569116;
    ipMatrixExpected(0,5,3) = 0.1459750566893417;
    ipMatrixExpected(0,6,3) = -0.25689112700183203;
    ipMatrixExpected(0,7,3) = -0.22550006385415894;
    ipMatrixExpected(0,8,3) = 0.011642264372516423;
    ipMatrixExpected(0,9,3) = -0.035058986376853604;
    ipMatrixExpected(0,10,3) = 0.1459750566893424;
    ipMatrixExpected(0,11,3) = -0.07211898376488812;
    ipMatrixExpected(0,12,3) = -0.0034013605442177715;
    ipMatrixExpected(0,13,3) = 0.011642264372516323;
    ipMatrixExpected(0,14,3) = -0.061245438975690514;
    ipMatrixExpected(0,15,3) = 0.043083900226757676;
    ipMatrixExpected(0,0,4) = -0.22550006385415977;
    ipMatrixExpected(0,1,4) = -0.25689112700183325;
    ipMatrixExpected(0,2,4) = 0.1459750566893433;
    ipMatrixExpected(0,3,4) = -0.06124543897569116;
    ipMatrixExpected(0,4,4) = 2.244897959183676;
    ipMatrixExpected(0,5,4) = -1.4824317442707666;
    ipMatrixExpected(0,6,4) = -0.005663493824484278;
    ipMatrixExpected(0,7,4) = 0.05668934240363208;
    ipMatrixExpected(0,8,4) = -0.022675736961449866;
    ipMatrixExpected(0,9,4) = -0.39496005112844856;
    ipMatrixExpected(0,10,4) = 0.14694417811257454;
    ipMatrixExpected(0,11,4) = -0.05668934240362803;
    ipMatrixExpected(0,12,4) = -0.07211898376488868;
    ipMatrixExpected(0,13,4) = 0.14597505668934396;
    ipMatrixExpected(0,14,4) = -0.035058986376852674;
    ipMatrixExpected(0,15,4) = 0.011642264372516201;
    ipMatrixExpected(0,0,5) = -0.25689112700183325;
    ipMatrixExpected(0,1,5) = -1.4824317442707629;
    ipMatrixExpected(0,2,5) = -0.39496005112845367;
    ipMatrixExpected(0,3,5) = 0.1459750566893417;
    ipMatrixExpected(0,4,5) = -1.4824317442707666;
    ipMatrixExpected(0,5,5) = 6.4625850340136015;
    ipMatrixExpected(0,6,5) = -0.9070294784580233;
    ipMatrixExpected(0,7,5) = -0.00566349382448289;
    ipMatrixExpected(0,8,5) = -0.3949600511284477;
    ipMatrixExpected(0,9,5) = -0.9070294784580477;
    ipMatrixExpected(0,10,5) = -0.48185941043084535;
    ipMatrixExpected(0,11,5) = 0.14694417811257748;
    ipMatrixExpected(0,12,5) = 0.14597505668934396;
    ipMatrixExpected(0,13,5) = -0.005663493824478616;
    ipMatrixExpected(0,14,5) = 0.14694417811258426;
    ipMatrixExpected(0,15,5) = -0.03505898637685055;
    ipMatrixExpected(0,0,6) = 0.14597505668934127;
    ipMatrixExpected(0,1,6) = -0.39496005112844845;
    ipMatrixExpected(0,2,6) = -1.482431744270763;
    ipMatrixExpected(0,3,6) = -0.25689112700183203;
    ipMatrixExpected(0,4,6) = -0.005663493824484278;
    ipMatrixExpected(0,5,6) = -0.9070294784580233;
    ipMatrixExpected(0,6,6) = 6.462585034013607;
    ipMatrixExpected(0,7,6) = -1.482431744270771;
    ipMatrixExpected(0,8,6) = 0.14694417811257543;
    ipMatrixExpected(0,9,6) = -0.48185941043087666;
    ipMatrixExpected(0,10,6) = -0.9070294784580464;
    ipMatrixExpected(0,11,6) = -0.394960051128445;
    ipMatrixExpected(0,12,6) = -0.03505898637685384;
    ipMatrixExpected(0,13,6) = 0.14694417811257954;
    ipMatrixExpected(0,14,6) = -0.005663493824483723;
    ipMatrixExpected(0,15,6) = 0.14597505668934352;
    ipMatrixExpected(0,0,7) = -0.06124543897569006;
    ipMatrixExpected(0,1,7) = 0.1459750566893411;
    ipMatrixExpected(0,2,7) = -0.2568911270018305;
    ipMatrixExpected(0,3,7) = -0.22550006385415894;
    ipMatrixExpected(0,4,7) = 0.05668934240363208;
    ipMatrixExpected(0,5,7) = -0.00566349382448289;
    ipMatrixExpected(0,6,7) = -1.482431744270771;
    ipMatrixExpected(0,7,7) = 2.2448979591836755;
    ipMatrixExpected(0,8,7) = -0.056689342403627864;
    ipMatrixExpected(0,9,7) = 0.14694417811257268;
    ipMatrixExpected(0,10,7) = -0.3949600511284459;
    ipMatrixExpected(0,11,7) = -0.02267573696145231;
    ipMatrixExpected(0,12,7) = 0.011642264372517367;
    ipMatrixExpected(0,13,7) = -0.035058986376853105;
    ipMatrixExpected(0,14,7) = 0.14597505668934374;
    ipMatrixExpected(0,15,7) = -0.07211898376488879;
    ipMatrixExpected(0,0,8) = -0.07211898376488846;
    ipMatrixExpected(0,1,8) = 0.14597505668934063;
    ipMatrixExpected(0,2,8) = -0.03505898637685309;
    ipMatrixExpected(0,3,8) = 0.011642264372516423;
    ipMatrixExpected(0,4,8) = -0.022675736961449866;
    ipMatrixExpected(0,5,8) = -0.3949600511284477;
    ipMatrixExpected(0,6,8) = 0.14694417811257543;
    ipMatrixExpected(0,7,8) = -0.056689342403627864;
    ipMatrixExpected(0,8,8) = 2.2448979591836737;
    ipMatrixExpected(0,9,8) = -1.4824317442707693;
    ipMatrixExpected(0,10,8) = -0.005663493824473398;
    ipMatrixExpected(0,11,8) = 0.05668934240362656;
    ipMatrixExpected(0,12,8) = -0.22550006385416005;
    ipMatrixExpected(0,13,8) = -0.2568911270018309;
    ipMatrixExpected(0,14,8) = 0.1459750566893427;
    ipMatrixExpected(0,15,8) = -0.06124543897569008;
    ipMatrixExpected(0,0,9) = 0.14597505668934174;
    ipMatrixExpected(0,1,9) = -0.005663493824473509;
    ipMatrixExpected(0,2,9) = 0.146944178112573;
    ipMatrixExpected(0,3,9) = -0.035058986376853604;
    ipMatrixExpected(0,4,9) = -0.39496005112844856;
    ipMatrixExpected(0,5,9) = -0.9070294784580477;
    ipMatrixExpected(0,6,9) = -0.48185941043087666;
    ipMatrixExpected(0,7,9) = 0.14694417811257268;
    ipMatrixExpected(0,8,9) = -1.4824317442707693;
    ipMatrixExpected(0,9,9) = 6.462585034013606;
    ipMatrixExpected(0,10,9) = -0.9070294784580477;
    ipMatrixExpected(0,11,9) = -0.005663493824471871;
    ipMatrixExpected(0,12,9) = -0.2568911270018318;
    ipMatrixExpected(0,13,9) = -1.4824317442707597;
    ipMatrixExpected(0,14,9) = -0.39496005112844773;
    ipMatrixExpected(0,15,9) = 0.14597505668934363;
    ipMatrixExpected(0,0,10) = -0.03505898637685316;
    ipMatrixExpected(0,1,10) = 0.1469441781125666;
    ipMatrixExpected(0,2,10) = -0.005663493824473287;
    ipMatrixExpected(0,3,10) = 0.1459750566893424;
    ipMatrixExpected(0,4,10) = 0.14694417811257454;
    ipMatrixExpected(0,5,10) = -0.48185941043084535;
    ipMatrixExpected(0,6,10) = -0.9070294784580464;
    ipMatrixExpected(0,7,10) = -0.3949600511284459;
    ipMatrixExpected(0,8,10) = -0.005663493824473398;
    ipMatrixExpected(0,9,10) = -0.9070294784580477;
    ipMatrixExpected(0,10,10) = 6.462585034013593;
    ipMatrixExpected(0,11,10) = -1.4824317442707644;
    ipMatrixExpected(0,12,10) = 0.14597505668934246;
    ipMatrixExpected(0,13,10) = -0.3949600511284378;
    ipMatrixExpected(0,14,10) = -1.4824317442707633;
    ipMatrixExpected(0,15,10) = -0.25689112700183114;
    ipMatrixExpected(0,0,11) = 0.011642264372517502;
    ipMatrixExpected(0,1,11) = -0.03505898637685291;
    ipMatrixExpected(0,2,11) = 0.1459750566893434;
    ipMatrixExpected(0,3,11) = -0.07211898376488812;
    ipMatrixExpected(0,4,11) = -0.05668934240362803;
    ipMatrixExpected(0,5,11) = 0.14694417811257748;
    ipMatrixExpected(0,6,11) = -0.394960051128445;
    ipMatrixExpected(0,7,11) = -0.02267573696145231;
    ipMatrixExpected(0,8,11) = 0.05668934240362656;
    ipMatrixExpected(0,9,11) = -0.005663493824471871;
    ipMatrixExpected(0,10,11) = -1.4824317442707644;
    ipMatrixExpected(0,11,11) = 2.244897959183673;
    ipMatrixExpected(0,12,11) = -0.06124543897569033;
    ipMatrixExpected(0,13,11) = 0.14597505668934319;
    ipMatrixExpected(0,14,11) = -0.2568911270018329;
    ipMatrixExpected(0,15,11) = -0.22550006385415988;
    ipMatrixExpected(0,0,12) = 0.04308390022675734;
    ipMatrixExpected(0,1,12) = -0.06124543897569151;
    ipMatrixExpected(0,2,12) = 0.01164226437251712;
    ipMatrixExpected(0,3,12) = -0.0034013605442177715;
    ipMatrixExpected(0,4,12) = -0.07211898376488868;
    ipMatrixExpected(0,5,12) = 0.14597505668934396;
    ipMatrixExpected(0,6,12) = -0.03505898637685384;
    ipMatrixExpected(0,7,12) = 0.011642264372517367;
    ipMatrixExpected(0,8,12) = -0.22550006385416005;
    ipMatrixExpected(0,9,12) = -0.2568911270018318;
    ipMatrixExpected(0,10,12) = 0.14597505668934246;
    ipMatrixExpected(0,11,12) = -0.06124543897569033;
    ipMatrixExpected(0,12,12) = 0.6394557823129252;
    ipMatrixExpected(0,13,12) = -0.22550006385415983;
    ipMatrixExpected(0,14,12) = -0.07211898376488801;
    ipMatrixExpected(0,15,12) = 0.04308390022675686;
    ipMatrixExpected(0,0,13) = -0.06124543897569068;
    ipMatrixExpected(0,1,13) = 0.05668934240362877;
    ipMatrixExpected(0,2,13) = -0.05668934240362705;
    ipMatrixExpected(0,3,13) = 0.011642264372516323;
    ipMatrixExpected(0,4,13) = 0.14597505668934396;
    ipMatrixExpected(0,5,13) = -0.005663493824478616;
    ipMatrixExpected(0,6,13) = 0.14694417811257954;
    ipMatrixExpected(0,7,13) = -0.035058986376853105;
    ipMatrixExpected(0,8,13) = -0.2568911270018309;
    ipMatrixExpected(0,9,13) = -1.4824317442707597;
    ipMatrixExpected(0,10,13) = -0.3949600511284378;
    ipMatrixExpected(0,11,13) = 0.14597505668934319;
    ipMatrixExpected(0,12,13) = -0.22550006385415983;
    ipMatrixExpected(0,13,13) = 2.2448979591836804;
    ipMatrixExpected(0,14,13) = -0.022675736961452586;
    ipMatrixExpected(0,15,13) = -0.07211898376488801;
    ipMatrixExpected(0,0,14) = 0.011642264372517065;
    ipMatrixExpected(0,1,14) = -0.056689342403626525;
    ipMatrixExpected(0,2,14) = 0.05668934240362833;
    ipMatrixExpected(0,3,14) = -0.061245438975690514;
    ipMatrixExpected(0,4,14) = -0.035058986376852674;
    ipMatrixExpected(0,5,14) = 0.14694417811258426;
    ipMatrixExpected(0,6,14) = -0.005663493824483723;
    ipMatrixExpected(0,7,14) = 0.14597505668934374;
    ipMatrixExpected(0,8,14) = 0.1459750566893427;
    ipMatrixExpected(0,9,14) = -0.39496005112844773;
    ipMatrixExpected(0,10,14) = -1.4824317442707633;
    ipMatrixExpected(0,11,14) = -0.2568911270018329;
    ipMatrixExpected(0,12,14) = -0.07211898376488801;
    ipMatrixExpected(0,13,14) = -0.022675736961452586;
    ipMatrixExpected(0,14,14) = 2.244897959183672;
    ipMatrixExpected(0,15,14) = -0.22550006385415985;
    ipMatrixExpected(0,0,15) = -0.003401360544217533;
    ipMatrixExpected(0,1,15) = 0.011642264372516295;
    ipMatrixExpected(0,2,15) = -0.06124543897569129;
    ipMatrixExpected(0,3,15) = 0.043083900226757676;
    ipMatrixExpected(0,4,15) = 0.011642264372516201;
    ipMatrixExpected(0,5,15) = -0.03505898637685055;
    ipMatrixExpected(0,6,15) = 0.14597505668934352;
    ipMatrixExpected(0,7,15) = -0.07211898376488879;
    ipMatrixExpected(0,8,15) = -0.06124543897569008;
    ipMatrixExpected(0,9,15) = 0.14597505668934363;
    ipMatrixExpected(0,10,15) = -0.25689112700183114;
    ipMatrixExpected(0,11,15) = -0.22550006385415988;
    ipMatrixExpected(0,12,15) = 0.04308390022675686;
    ipMatrixExpected(0,13,15) = -0.07211898376488801;
    ipMatrixExpected(0,14,15) = -0.22550006385415985;
    ipMatrixExpected(0,15,15) = 0.639455782312925;
  }
  
  static void expectedOptTestWeightsForCubicsOnQuad(FieldContainer<double> & optTestWeights, bool conformingTraces) {
    if (! conformingTraces) {
      optTestWeights.resize(1,16,16);
      optTestWeights(0,0,0) = 0.6275677526325448;
      optTestWeights(0,1,0) = 0.3843365488514948;
      optTestWeights(0,2,0) = -0.09940976675404194;
      optTestWeights(0,3,0) = 0.052944206991863654;
      optTestWeights(0,4,0) = -0.1154061676306024;
      optTestWeights(0,5,0) = 0.07616853779028006;
      optTestWeights(0,6,0) = 0.016928873660661935;
      optTestWeights(0,7,0) = -0.005629985542192031;
      optTestWeights(0,8,0) = -0.005629985542190374;
      optTestWeights(0,9,0) = 0.016928873660661155;
      optTestWeights(0,10,0) = 0.07616853779027691;
      optTestWeights(0,11,0) = -0.11540616763060342;
      optTestWeights(0,12,0) = 0.05294420699186335;
      optTestWeights(0,13,0) = -0.0994097667540447;
      optTestWeights(0,14,0) = 0.384336548851492;
      optTestWeights(0,15,0) = 0.6275677526325443;
      optTestWeights(0,0,1) = 0.08792436841271173;
      optTestWeights(0,1,1) = 0.8033493023606121;
      optTestWeights(0,2,1) = 0.10510408294175622;
      optTestWeights(0,3,1) = -0.03093901199322124;
      optTestWeights(0,4,1) = 0.09809815395464329;
      optTestWeights(0,5,1) = 0.026313190077391555;
      optTestWeights(0,6,1) = -0.012077312604247914;
      optTestWeights(0,7,1) = 0.007156888280808963;
      optTestWeights(0,8,1) = 0.002031725266313445;
      optTestWeights(0,9,1) = 0.02403961241200883;
      optTestWeights(0,10,1) = -0.07059783642405328;
      optTestWeights(0,11,1) = 0.016587757023874983;
      optTestWeights(0,12,1) = -0.016619732570745536;
      optTestWeights(0,13,1) = 0.02857349122292207;
      optTestWeights(0,14,1) = -0.11841420740573744;
      optTestWeights(0,15,1) = -0.20053047095502757;
      optTestWeights(0,0,2) = -0.030939011993220043;
      optTestWeights(0,1,2) = 0.10510408294175853;
      optTestWeights(0,2,2) = 0.8033493023606102;
      optTestWeights(0,3,2) = 0.08792436841270922;
      optTestWeights(0,4,2) = -0.200530470955029;
      optTestWeights(0,5,2) = -0.11841420740573382;
      optTestWeights(0,6,2) = 0.02857349122292747;
      optTestWeights(0,7,2) = -0.016619732570744943;
      optTestWeights(0,8,2) = 0.016587757023875906;
      optTestWeights(0,9,2) = -0.07059783642405265;
      optTestWeights(0,10,2) = 0.024039612412004877;
      optTestWeights(0,11,2) = 0.002031725266311527;
      optTestWeights(0,12,2) = 0.007156888280808021;
      optTestWeights(0,13,2) = -0.012077312604253664;
      optTestWeights(0,14,2) = 0.026313190077389217;
      optTestWeights(0,15,2) = 0.09809815395464419;
      optTestWeights(0,0,3) = 0.05294420699186559;
      optTestWeights(0,1,3) = -0.09940976675403938;
      optTestWeights(0,2,3) = 0.3843365488514902;
      optTestWeights(0,3,3) = 0.6275677526325447;
      optTestWeights(0,4,3) = 0.6275677526325462;
      optTestWeights(0,5,3) = 0.3843365488515003;
      optTestWeights(0,6,3) = -0.09940976675404131;
      optTestWeights(0,7,3) = 0.05294420699186358;
      optTestWeights(0,8,3) = -0.11540616763060373;
      optTestWeights(0,9,3) = 0.07616853779027707;
      optTestWeights(0,10,3) = 0.01692887366065641;
      optTestWeights(0,11,3) = -0.0056299855421926065;
      optTestWeights(0,12,3) = -0.005629985542192478;
      optTestWeights(0,13,3) = 0.01692887366065934;
      optTestWeights(0,14,3) = 0.07616853779028043;
      optTestWeights(0,15,3) = -0.11540616763060149;
      optTestWeights(0,0,4) = -0.20053047095502977;
      optTestWeights(0,1,4) = -0.11841420740574034;
      optTestWeights(0,2,4) = 0.028573491222924317;
      optTestWeights(0,3,4) = -0.016619732570744897;
      optTestWeights(0,4,4) = 0.01658775702387608;
      optTestWeights(0,5,4) = -0.07059783642405121;
      optTestWeights(0,6,4) = 0.024039612412009335;
      optTestWeights(0,7,4) = 0.0020317252663116427;
      optTestWeights(0,8,4) = 0.007156888280810733;
      optTestWeights(0,9,4) = -0.012077312604248535;
      optTestWeights(0,10,4) = 0.026313190077385303;
      optTestWeights(0,11,4) = 0.09809815395464198;
      optTestWeights(0,12,4) = -0.030939011993221573;
      optTestWeights(0,13,4) = 0.10510408294175418;
      optTestWeights(0,14,4) = 0.8033493023606142;
      optTestWeights(0,15,4) = 0.08792436841271198;
      optTestWeights(0,0,5) = -0.027042560306945677;
      optTestWeights(0,1,5) = -0.25524815662758116;
      optTestWeights(0,2,5) = -0.033774619844444555;
      optTestWeights(0,3,5) = 0.009074417070382557;
      optTestWeights(0,4,5) = 0.006140135219630244;
      optTestWeights(0,5,5) = 0.10869786344027431;
      optTestWeights(0,6,5) = 0.00794588077369232;
      optTestWeights(0,7,5) = -0.00329295972500274;
      optTestWeights(0,8,5) = -0.003292959725000876;
      optTestWeights(0,9,5) = 0.007945880773691327;
      optTestWeights(0,10,5) = 0.10869786344026901;
      optTestWeights(0,11,5) = 0.006140135219628731;
      optTestWeights(0,12,5) = 0.009074417070381945;
      optTestWeights(0,13,5) = -0.03377461984444668;
      optTestWeights(0,14,5) = -0.2552481566275792;
      optTestWeights(0,15,5) = -0.02704256030694445;
      optTestWeights(0,0,6) = 0.00907441707038359;
      optTestWeights(0,1,6) = -0.03377461984444275;
      optTestWeights(0,2,6) = -0.25524815662758266;
      optTestWeights(0,3,6) = -0.027042560306946906;
      optTestWeights(0,4,6) = -0.027042560306945077;
      optTestWeights(0,5,6) = -0.2552481566275776;
      optTestWeights(0,6,6) = -0.03377461984444349;
      optTestWeights(0,7,6) = 0.009074417070382583;
      optTestWeights(0,8,6) = 0.0061401352196294;
      optTestWeights(0,9,6) = 0.10869786344026924;
      optTestWeights(0,10,6) = 0.007945880773687821;
      optTestWeights(0,11,6) = -0.003292959725002323;
      optTestWeights(0,12,6) = -0.0032929597250033987;
      optTestWeights(0,13,6) = 0.00794588077368758;
      optTestWeights(0,14,6) = 0.10869786344027459;
      optTestWeights(0,15,6) = 0.006140135219631204;
      optTestWeights(0,0,7) = -0.016619732570744044;
      optTestWeights(0,1,7) = 0.028573491222927194;
      optTestWeights(0,2,7) = -0.11841420740574062;
      optTestWeights(0,3,7) = -0.20053047095503082;
      optTestWeights(0,4,7) = 0.08792436841271124;
      optTestWeights(0,5,7) = 0.8033493023606152;
      optTestWeights(0,6,7) = 0.10510408294175547;
      optTestWeights(0,7,7) = -0.03093901199322113;
      optTestWeights(0,8,7) = 0.09809815395464248;
      optTestWeights(0,9,7) = 0.026313190077384845;
      optTestWeights(0,10,7) = -0.012077312604253508;
      optTestWeights(0,11,7) = 0.007156888280808744;
      optTestWeights(0,12,7) = 0.0020317252663106583;
      optTestWeights(0,13,7) = 0.024039612412005675;
      optTestWeights(0,14,7) = -0.07059783642405015;
      optTestWeights(0,15,7) = 0.016587757023876874;
      optTestWeights(0,0,8) = 0.0980981539546422;
      optTestWeights(0,1,8) = 0.026313190077385622;
      optTestWeights(0,2,8) = -0.01207731260425237;
      optTestWeights(0,3,8) = 0.007156888280809984;
      optTestWeights(0,4,8) = 0.0020317252663138237;
      optTestWeights(0,5,8) = 0.024039612412008794;
      optTestWeights(0,6,8) = -0.07059783642404974;
      optTestWeights(0,7,8) = 0.016587757023874074;
      optTestWeights(0,8,8) = -0.01661973257074442;
      optTestWeights(0,9,8) = 0.02857349122292747;
      optTestWeights(0,10,8) = -0.11841420740574234;
      optTestWeights(0,11,8) = -0.20053047095503024;
      optTestWeights(0,12,8) = 0.08792436841270938;
      optTestWeights(0,13,8) = 0.803349302360607;
      optTestWeights(0,14,8) = 0.10510408294175907;
      optTestWeights(0,15,8) = -0.030939011993219717;
      optTestWeights(0,0,9) = 0.006140135219628983;
      optTestWeights(0,1,9) = 0.10869786344026898;
      optTestWeights(0,2,9) = 0.007945880773688295;
      optTestWeights(0,3,9) = -0.0032929597250017846;
      optTestWeights(0,4,9) = -0.003292959725000407;
      optTestWeights(0,5,9) = 0.007945880773690612;
      optTestWeights(0,6,9) = 0.1086978634402709;
      optTestWeights(0,7,9) = 0.006140135219627951;
      optTestWeights(0,8,9) = 0.009074417070383612;
      optTestWeights(0,9,9) = -0.033774619844442716;
      optTestWeights(0,10,9) = -0.2552481566275834;
      optTestWeights(0,11,9) = -0.027042560306946375;
      optTestWeights(0,12,9) = -0.02704256030694675;
      optTestWeights(0,13,9) = -0.25524815662758243;
      optTestWeights(0,14,9) = -0.03377461984444043;
      optTestWeights(0,15,9) = 0.009074417070384366;
      optTestWeights(0,0,10) = -0.003292959725002209;
      optTestWeights(0,1,10) = 0.007945880773689226;
      optTestWeights(0,2,10) = 0.10869786344026904;
      optTestWeights(0,3,10) = 0.0061401352196285685;
      optTestWeights(0,4,10) = 0.00907441707038417;
      optTestWeights(0,5,10) = -0.033774619844442855;
      optTestWeights(0,6,10) = -0.25524815662758216;
      optTestWeights(0,7,10) = -0.027042560306946992;
      optTestWeights(0,8,10) = -0.027042560306945747;
      optTestWeights(0,9,10) = -0.255248156627582;
      optTestWeights(0,10,10) = -0.03377461984444512;
      optTestWeights(0,11,10) = 0.009074417070383109;
      optTestWeights(0,12,10) = 0.006140135219628053;
      optTestWeights(0,13,10) = 0.10869786344026981;
      optTestWeights(0,14,10) = 0.007945880773695025;
      optTestWeights(0,15,10) = -0.0032929597250001565;
      optTestWeights(0,0,11) = 0.007156888280809276;
      optTestWeights(0,1,11) = -0.012077312604251407;
      optTestWeights(0,2,11) = 0.026313190077386455;
      optTestWeights(0,3,11) = 0.0980981539546421;
      optTestWeights(0,4,11) = -0.030939011993219755;
      optTestWeights(0,5,11) = 0.10510408294175731;
      optTestWeights(0,6,11) = 0.8033493023606088;
      optTestWeights(0,7,11) = 0.08792436841270898;
      optTestWeights(0,8,11) = -0.2005304709550299;
      optTestWeights(0,9,11) = -0.11841420740574064;
      optTestWeights(0,10,11) = 0.028573491222924834;
      optTestWeights(0,11,11) = -0.016619732570744967;
      optTestWeights(0,12,11) = 0.016587757023874314;
      optTestWeights(0,13,11) = -0.07059783642405093;
      optTestWeights(0,14,11) = 0.024039612412013193;
      optTestWeights(0,15,11) = 0.002031725266314346;
      optTestWeights(0,0,12) = -0.11540616763060287;
      optTestWeights(0,1,12) = 0.07616853779027748;
      optTestWeights(0,2,12) = 0.016928873660657137;
      optTestWeights(0,3,12) = -0.0056299855421908795;
      optTestWeights(0,4,12) = -0.005629985542189588;
      optTestWeights(0,5,12) = 0.016928873660658615;
      optTestWeights(0,6,12) = 0.07616853779027949;
      optTestWeights(0,7,12) = -0.11540616763060388;
      optTestWeights(0,8,12) = 0.052944206991865236;
      optTestWeights(0,9,12) = -0.09940976675403877;
      optTestWeights(0,10,12) = 0.38433654885148805;
      optTestWeights(0,11,12) = 0.6275677526325435;
      optTestWeights(0,12,12) = 0.6275677526325418;
      optTestWeights(0,13,12) = 0.38433654885148794;
      optTestWeights(0,14,12) = -0.0994097667540379;
      optTestWeights(0,15,12) = 0.052944206991865125;
      optTestWeights(0,0,13) = 0.016587757023875167;
      optTestWeights(0,1,13) = -0.07059783642405391;
      optTestWeights(0,2,13) = 0.024039612412004908;
      optTestWeights(0,3,13) = 0.002031725266312441;
      optTestWeights(0,4,13) = 0.007156888280810958;
      optTestWeights(0,5,13) = -0.012077312604250979;
      optTestWeights(0,6,13) = 0.026313190077389532;
      optTestWeights(0,7,13) = 0.098098153954641;
      optTestWeights(0,8,13) = -0.03093901199322034;
      optTestWeights(0,9,13) = 0.10510408294175916;
      optTestWeights(0,10,13) = 0.8033493023606094;
      optTestWeights(0,11,13) = 0.08792436841271013;
      optTestWeights(0,12,13) = -0.20053047095503068;
      optTestWeights(0,13,13) = -0.1184142074057412;
      optTestWeights(0,14,13) = 0.028573491222928505;
      optTestWeights(0,15,13) = -0.016619732570743694;
      optTestWeights(0,0,14) = 0.0020317252663115894;
      optTestWeights(0,1,14) = 0.024039612412006094;
      optTestWeights(0,2,14) = -0.07059783642405251;
      optTestWeights(0,3,14) = 0.0165877570238753;
      optTestWeights(0,4,14) = -0.01661973257074343;
      optTestWeights(0,5,14) = 0.028573491222926208;
      optTestWeights(0,6,14) = -0.11841420740574063;
      optTestWeights(0,7,14) = -0.2005304709550312;
      optTestWeights(0,8,14) = 0.08792436841271016;
      optTestWeights(0,9,14) = 0.8033493023606106;
      optTestWeights(0,10,14) = 0.10510408294175623;
      optTestWeights(0,11,14) = -0.030939011993220758;
      optTestWeights(0,12,14) = 0.09809815395464123;
      optTestWeights(0,13,14) = 0.026313190077386778;
      optTestWeights(0,14,14) = -0.012077312604244935;
      optTestWeights(0,15,14) = 0.007156888280811105;
      optTestWeights(0,0,15) = -0.0056299855421926845;
      optTestWeights(0,1,15) = 0.016928873660658886;
      optTestWeights(0,2,15) = 0.07616853779027948;
      optTestWeights(0,3,15) = -0.11540616763060364;
      optTestWeights(0,4,15) = 0.05294420699186487;
      optTestWeights(0,5,15) = -0.09940976675404041;
      optTestWeights(0,6,15) = 0.3843365488514883;
      optTestWeights(0,7,15) = 0.6275677526325416;
      optTestWeights(0,8,15) = 0.6275677526325429;
      optTestWeights(0,9,15) = 0.3843365488514875;
      optTestWeights(0,10,15) = -0.09940976675404166;
      optTestWeights(0,11,15) = 0.052944206991865306;
      optTestWeights(0,12,15) = -0.11540616763060363;
      optTestWeights(0,13,15) = 0.07616853779027825;
      optTestWeights(0,14,15) = 0.016928873660665315;
      optTestWeights(0,15,15) = -0.005629985542189624;
    } else {
      optTestWeights.resize(1,12,16);
      optTestWeights(0,0,0) = 1.255135505265089;
      optTestWeights(0,1,0) = 0.3843365488514948;
      optTestWeights(0,2,0) = -0.09940976675404194;
      optTestWeights(0,3,0) = -0.062461960638738837;
      optTestWeights(0,4,0) = 0.07616853779028006;
      optTestWeights(0,5,0) = 0.016928873660661935;
      optTestWeights(0,6,0) = -0.011259971084382448;
      optTestWeights(0,7,0) = 0.016928873660661155;
      optTestWeights(0,8,0) = 0.07616853779027692;
      optTestWeights(0,9,0) = -0.06246196063874008;
      optTestWeights(0,10,0) = -0.09940976675404462;
      optTestWeights(0,11,0) = 0.38433654885149215;
      optTestWeights(0,0,1) = -0.11260610254231586;
      optTestWeights(0,1,1) = 0.8033493023606121;
      optTestWeights(0,2,1) = 0.10510408294175622;
      optTestWeights(0,3,1) = 0.06715914196142204;
      optTestWeights(0,4,1) = 0.026313190077391555;
      optTestWeights(0,5,1) = -0.012077312604247914;
      optTestWeights(0,6,1) = 0.009188613547122353;
      optTestWeights(0,7,1) = 0.02403961241200883;
      optTestWeights(0,8,1) = -0.07059783642405322;
      optTestWeights(0,9,1) = -0.000031975546870522165;
      optTestWeights(0,10,1) = 0.028573491222922135;
      optTestWeights(0,11,1) = -0.1184142074057372;
      optTestWeights(0,0,2) = 0.06715914196142407;
      optTestWeights(0,1,2) = 0.10510408294175853;
      optTestWeights(0,2,2) = 0.8033493023606102;
      optTestWeights(0,3,2) = -0.11260610254231974;
      optTestWeights(0,4,2) = -0.11841420740573382;
      optTestWeights(0,5,2) = 0.02857349122292747;
      optTestWeights(0,6,2) = -0.000031975546869104286;
      optTestWeights(0,7,2) = -0.07059783642405265;
      optTestWeights(0,8,2) = 0.024039612412004894;
      optTestWeights(0,9,2) = 0.009188613547119548;
      optTestWeights(0,10,2) = -0.012077312604253631;
      optTestWeights(0,11,2) = 0.026313190077389418;
      optTestWeights(0,0,3) = -0.06246196063873593;
      optTestWeights(0,1,3) = -0.09940976675403938;
      optTestWeights(0,2,3) = 0.3843365488514902;
      optTestWeights(0,3,3) = 1.255135505265091;
      optTestWeights(0,4,3) = 0.3843365488515003;
      optTestWeights(0,5,3) = -0.09940976675404131;
      optTestWeights(0,6,3) = -0.06246196063874024;
      optTestWeights(0,7,3) = 0.07616853779027707;
      optTestWeights(0,8,3) = 0.01692887366065644;
      optTestWeights(0,9,3) = -0.011259971084385091;
      optTestWeights(0,10,3) = 0.01692887366065937;
      optTestWeights(0,11,3) = 0.0761685377902806;
      optTestWeights(0,0,4) = -0.1126061025423179;
      optTestWeights(0,1,4) = -0.11841420740574034;
      optTestWeights(0,2,4) = 0.028573491222924317;
      optTestWeights(0,3,4) = -0.000031975546868860896;
      optTestWeights(0,4,4) = -0.07059783642405121;
      optTestWeights(0,5,4) = 0.024039612412009335;
      optTestWeights(0,6,4) = 0.00918861354712232;
      optTestWeights(0,7,4) = -0.012077312604248535;
      optTestWeights(0,8,4) = 0.026313190077385345;
      optTestWeights(0,9,4) = 0.06715914196142042;
      optTestWeights(0,10,4) = 0.10510408294175429;
      optTestWeights(0,11,4) = 0.8033493023606144;
      optTestWeights(0,0,5) = -0.05408512061389019;
      optTestWeights(0,1,5) = -0.25524815662758116;
      optTestWeights(0,2,5) = -0.033774619844444555;
      optTestWeights(0,3,5) = 0.01521455229001277;
      optTestWeights(0,4,5) = 0.10869786344027431;
      optTestWeights(0,5,5) = 0.00794588077369232;
      optTestWeights(0,6,5) = -0.0065859194500036775;
      optTestWeights(0,7,5) = 0.007945880773691327;
      optTestWeights(0,8,5) = 0.10869786344026905;
      optTestWeights(0,9,5) = 0.015214552290010687;
      optTestWeights(0,10,5) = -0.0337746198444466;
      optTestWeights(0,11,5) = -0.255248156627579;
      optTestWeights(0,0,6) = 0.01521455229001474;
      optTestWeights(0,1,6) = -0.03377461984444275;
      optTestWeights(0,2,6) = -0.25524815662758266;
      optTestWeights(0,3,6) = -0.054085120613892014;
      optTestWeights(0,4,6) = -0.2552481566275776;
      optTestWeights(0,5,6) = -0.03377461984444349;
      optTestWeights(0,6,6) = 0.015214552290011906;
      optTestWeights(0,7,6) = 0.10869786344026924;
      optTestWeights(0,8,6) = 0.007945880773687849;
      optTestWeights(0,9,6) = -0.006585919450005722;
      optTestWeights(0,10,6) = 0.007945880773687615;
      optTestWeights(0,11,6) = 0.10869786344027481;
      optTestWeights(0,0,7) = -0.00003197554686722139;
      optTestWeights(0,1,7) = 0.028573491222927194;
      optTestWeights(0,2,7) = -0.11841420740574062;
      optTestWeights(0,3,7) = -0.11260610254231959;
      optTestWeights(0,4,7) = 0.8033493023606152;
      optTestWeights(0,5,7) = 0.10510408294175547;
      optTestWeights(0,6,7) = 0.06715914196142128;
      optTestWeights(0,7,7) = 0.026313190077384845;
      optTestWeights(0,8,7) = -0.012077312604253472;
      optTestWeights(0,9,7) = 0.009188613547119398;
      optTestWeights(0,10,7) = 0.0240396124120057;
      optTestWeights(0,11,7) = -0.07059783642404999;
      optTestWeights(0,0,8) = 0.06715914196142245;
      optTestWeights(0,1,8) = 0.026313190077385622;
      optTestWeights(0,2,8) = -0.01207731260425237;
      optTestWeights(0,3,8) = 0.009188613547123766;
      optTestWeights(0,4,8) = 0.024039612412008794;
      optTestWeights(0,5,8) = -0.07059783642404974;
      optTestWeights(0,6,8) = -0.00003197554687040054;
      optTestWeights(0,7,8) = 0.02857349122292747;
      optTestWeights(0,8,8) = -0.11841420740574225;
      optTestWeights(0,9,8) = -0.11260610254232087;
      optTestWeights(0,10,8) = 0.8033493023606072;
      optTestWeights(0,11,8) = 0.10510408294175914;
      optTestWeights(0,0,9) = 0.01521455229001331;
      optTestWeights(0,1,9) = 0.10869786344026898;
      optTestWeights(0,2,9) = 0.007945880773688295;
      optTestWeights(0,3,9) = -0.006585919450002233;
      optTestWeights(0,4,9) = 0.007945880773690612;
      optTestWeights(0,5,9) = 0.1086978634402709;
      optTestWeights(0,6,9) = 0.015214552290011495;
      optTestWeights(0,7,9) = -0.033774619844442716;
      optTestWeights(0,8,9) = -0.25524815662758327;
      optTestWeights(0,9,9) = -0.05408512061389311;
      optTestWeights(0,10,9) = -0.25524815662758227;
      optTestWeights(0,11,9) = -0.03377461984444032;
      optTestWeights(0,0,10) = -0.006585919450002404;
      optTestWeights(0,1,10) = 0.007945880773689226;
      optTestWeights(0,2,10) = 0.10869786344026904;
      optTestWeights(0,3,10) = 0.015214552290012694;
      optTestWeights(0,4,10) = -0.033774619844442855;
      optTestWeights(0,5,10) = -0.25524815662758216;
      optTestWeights(0,6,10) = -0.05408512061389288;
      optTestWeights(0,7,10) = -0.255248156627582;
      optTestWeights(0,8,10) = -0.03377461984444507;
      optTestWeights(0,9,10) = 0.01521455229001118;
      optTestWeights(0,10,10) = 0.10869786344026984;
      optTestWeights(0,11,10) = 0.007945880773695133;
      optTestWeights(0,0,11) = 0.009188613547123577;
      optTestWeights(0,1,11) = -0.012077312604251407;
      optTestWeights(0,2,11) = 0.026313190077386455;
      optTestWeights(0,3,11) = 0.0671591419614223;
      optTestWeights(0,4,11) = 0.10510408294175731;
      optTestWeights(0,5,11) = 0.8033493023606088;
      optTestWeights(0,6,11) = -0.1126061025423211;
      optTestWeights(0,7,11) = -0.11841420740574064;
      optTestWeights(0,8,11) = 0.0285734912229249;
      optTestWeights(0,9,11) = -0.00003197554687062384;
      optTestWeights(0,10,11) = -0.07059783642405093;
      optTestWeights(0,11,11) = 0.0240396124120133;
      optTestWeights(0,0,12) = -0.06246196063873776;
      optTestWeights(0,1,12) = 0.07616853779027748;
      optTestWeights(0,2,12) = 0.016928873660657137;
      optTestWeights(0,3,12) = -0.011259971084380501;
      optTestWeights(0,4,12) = 0.016928873660658615;
      optTestWeights(0,5,12) = 0.07616853779027949;
      optTestWeights(0,6,12) = -0.062461960638738726;
      optTestWeights(0,7,12) = -0.09940976675403877;
      optTestWeights(0,8,12) = 0.3843365488514881;
      optTestWeights(0,9,12) = 1.2551355052650854;
      optTestWeights(0,10,12) = 0.3843365488514882;
      optTestWeights(0,11,12) = -0.09940976675403787;
      optTestWeights(0,0,13) = -0.00003197554686855231;
      optTestWeights(0,1,13) = -0.07059783642405391;
      optTestWeights(0,2,13) = 0.024039612412004908;
      optTestWeights(0,3,13) = 0.009188613547123355;
      optTestWeights(0,4,13) = -0.012077312604250979;
      optTestWeights(0,5,13) = 0.026313190077389532;
      optTestWeights(0,6,13) = 0.06715914196142056;
      optTestWeights(0,7,13) = 0.10510408294175916;
      optTestWeights(0,8,13) = 0.8033493023606094;
      optTestWeights(0,9,13) = -0.11260610254232052;
      optTestWeights(0,10,13) = -0.11841420740574105;
      optTestWeights(0,11,13) = 0.028573491222928574;
      optTestWeights(0,0,14) = 0.009188613547122667;
      optTestWeights(0,1,14) = 0.024039612412006094;
      optTestWeights(0,2,14) = -0.07059783642405251;
      optTestWeights(0,3,14) = -0.000031975546868173;
      optTestWeights(0,4,14) = 0.028573491222926208;
      optTestWeights(0,5,14) = -0.11841420740574063;
      optTestWeights(0,6,14) = -0.11260610254232126;
      optTestWeights(0,7,14) = 0.8033493023606106;
      optTestWeights(0,8,14) = 0.10510408294175631;
      optTestWeights(0,9,14) = 0.06715914196142052;
      optTestWeights(0,10,14) = 0.026313190077386826;
      optTestWeights(0,11,14) = -0.012077312604244847;
      optTestWeights(0,0,15) = -0.011259971084382335;
      optTestWeights(0,1,15) = 0.016928873660658886;
      optTestWeights(0,2,15) = 0.07616853779027948;
      optTestWeights(0,3,15) = -0.06246196063873887;
      optTestWeights(0,4,15) = -0.09940976675404041;
      optTestWeights(0,5,15) = 0.3843365488514883;
      optTestWeights(0,6,15) = 1.2551355052650843;
      optTestWeights(0,7,15) = 0.3843365488514875;
      optTestWeights(0,8,15) = -0.09940976675404162;
      optTestWeights(0,9,15) = -0.06246196063873829;
      optTestWeights(0,10,15) = 0.07616853779027825;
      optTestWeights(0,11,15) = 0.016928873660665398;
    }
  }
  
  static void expectedFinalStiffnessForCubicsOnQuad(FieldContainer<double> & finalStiffnessExpected, bool conformingTraces) {
    if (! conformingTraces) {
      finalStiffnessExpected.resize(1,16,16);
      finalStiffnessExpected(0,0,0) = 0.4475982354968517;
      finalStiffnessExpected(0,1,0) = 0.39303908181994723;
      finalStiffnessExpected(0,2,0) = -0.19409897985233873;
      finalStiffnessExpected(0,3,0) = 0.0762472585620347;
      finalStiffnessExpected(0,4,0) = 0.015295168289222378;
      finalStiffnessExpected(0,5,0) = -0.018081593585048586;
      finalStiffnessExpected(0,6,0) = -0.009297475974199654;
      finalStiffnessExpected(0,7,0) = 0.012083901270027113;
      finalStiffnessExpected(0,8,0) = -0.04069639866315295;
      finalStiffnessExpected(0,9,0) = 0.0952355313745713;
      finalStiffnessExpected(0,10,0) = -0.10516353656798394;
      finalStiffnessExpected(0,11,0) = -0.20341119216992581;
      finalStiffnessExpected(0,12,0) = 0.015295168289222295;
      finalStiffnessExpected(0,13,0) = 0.031309281682341206;
      finalStiffnessExpected(0,14,0) = -0.20554311534889969;
      finalStiffnessExpected(0,15,0) = 0.1589386653773352;
      finalStiffnessExpected(0,0,1) = 0.393039081819947;
      finalStiffnessExpected(0,1,1) = 2.768471070769949;
      finalStiffnessExpected(0,2,1) = 0.6465168073949071;
      finalStiffnessExpected(0,3,1) = -0.19409897985233918;
      finalStiffnessExpected(0,4,1) = 0.031309281682341115;
      finalStiffnessExpected(0,5,1) = -0.04265812023285908;
      finalStiffnessExpected(0,6,1) = 0.02064631452471699;
      finalStiffnessExpected(0,7,1) = -0.00929747597419937;
      finalStiffnessExpected(0,8,1) = 0.09523553137457202;
      finalStiffnessExpected(0,9,1) = -0.19480861962500412;
      finalStiffnessExpected(0,10,1) = -1.065441355314039;
      finalStiffnessExpected(0,11,1) = -0.10516353656798387;
      finalStiffnessExpected(0,12,1) = -0.018081593585048288;
      finalStiffnessExpected(0,13,1) = -0.0426581202328597;
      finalStiffnessExpected(0,14,1) = 0.2662828291668065;
      finalStiffnessExpected(0,15,1) = -0.20554311534889796;
      finalStiffnessExpected(0,0,2) = -0.19409897985233868;
      finalStiffnessExpected(0,1,2) = 0.6465168073949071;
      finalStiffnessExpected(0,2,2) = 2.768471070769943;
      finalStiffnessExpected(0,3,2) = 0.3930390818199436;
      finalStiffnessExpected(0,4,2) = -0.2055431153488994;
      finalStiffnessExpected(0,5,2) = 0.26628282916680907;
      finalStiffnessExpected(0,6,2) = -0.04265812023285687;
      finalStiffnessExpected(0,7,2) = -0.018081593585049033;
      finalStiffnessExpected(0,8,2) = -0.10516353656798257;
      finalStiffnessExpected(0,9,2) = -1.0654413553140347;
      finalStiffnessExpected(0,10,2) = -0.19480861962500462;
      finalStiffnessExpected(0,11,2) = 0.09523553137457128;
      finalStiffnessExpected(0,12,2) = -0.009297475974199217;
      finalStiffnessExpected(0,13,2) = 0.02064631452471839;
      finalStiffnessExpected(0,14,2) = -0.04265812023286073;
      finalStiffnessExpected(0,15,2) = 0.031309281682341435;
      finalStiffnessExpected(0,0,3) = 0.07624725856203468;
      finalStiffnessExpected(0,1,3) = -0.19409897985233918;
      finalStiffnessExpected(0,2,3) = 0.3930390818199435;
      finalStiffnessExpected(0,3,3) = 0.4475982354968512;
      finalStiffnessExpected(0,4,3) = 0.1589386653773362;
      finalStiffnessExpected(0,5,3) = -0.205543115348897;
      finalStiffnessExpected(0,6,3) = 0.03130928168234228;
      finalStiffnessExpected(0,7,3) = 0.015295168289221867;
      finalStiffnessExpected(0,8,3) = -0.20341119216992587;
      finalStiffnessExpected(0,9,3) = -0.10516353656798254;
      finalStiffnessExpected(0,10,3) = 0.09523553137457177;
      finalStiffnessExpected(0,11,3) = -0.0406963986631528;
      finalStiffnessExpected(0,12,3) = 0.012083901270027505;
      finalStiffnessExpected(0,13,3) = -0.009297475974198735;
      finalStiffnessExpected(0,14,3) = -0.01808159358504909;
      finalStiffnessExpected(0,15,3) = 0.015295168289222075;
      finalStiffnessExpected(0,0,4) = 0.01529516828922238;
      finalStiffnessExpected(0,1,4) = 0.03130928168234112;
      finalStiffnessExpected(0,2,4) = -0.2055431153488994;
      finalStiffnessExpected(0,3,4) = 0.15893866537733609;
      finalStiffnessExpected(0,4,4) = 0.44759823549685146;
      finalStiffnessExpected(0,5,4) = 0.3930390818199474;
      finalStiffnessExpected(0,6,4) = -0.1940989798523393;
      finalStiffnessExpected(0,7,4) = 0.07624725856203407;
      finalStiffnessExpected(0,8,4) = 0.01529516828922177;
      finalStiffnessExpected(0,9,4) = -0.018081593585049027;
      finalStiffnessExpected(0,10,4) = -0.009297475974200059;
      finalStiffnessExpected(0,11,4) = 0.012083901270027134;
      finalStiffnessExpected(0,12,4) = -0.040696398663152195;
      finalStiffnessExpected(0,13,4) = 0.09523553137457223;
      finalStiffnessExpected(0,14,4) = -0.10516353656798509;
      finalStiffnessExpected(0,15,4) = -0.20341119216992593;
      finalStiffnessExpected(0,0,5) = -0.018081593585048596;
      finalStiffnessExpected(0,1,5) = -0.04265812023285916;
      finalStiffnessExpected(0,2,5) = 0.2662828291668091;
      finalStiffnessExpected(0,3,5) = -0.20554311534889727;
      finalStiffnessExpected(0,4,5) = 0.39303908181994723;
      finalStiffnessExpected(0,5,5) = 2.7684710707699525;
      finalStiffnessExpected(0,6,5) = 0.6465168073949028;
      finalStiffnessExpected(0,7,5) = -0.1940989798523397;
      finalStiffnessExpected(0,8,5) = 0.03130928168234165;
      finalStiffnessExpected(0,9,5) = -0.04265812023285785;
      finalStiffnessExpected(0,10,5) = 0.020646314524717505;
      finalStiffnessExpected(0,11,5) = -0.009297475974200987;
      finalStiffnessExpected(0,12,5) = 0.09523553137457191;
      finalStiffnessExpected(0,13,5) = -0.19480861962500093;
      finalStiffnessExpected(0,14,5) = -1.0654413553140447;
      finalStiffnessExpected(0,15,5) = -0.10516353656798566;
      finalStiffnessExpected(0,0,6) = -0.009297475974199658;
      finalStiffnessExpected(0,1,6) = 0.02064631452471697;
      finalStiffnessExpected(0,2,6) = -0.04265812023285686;
      finalStiffnessExpected(0,3,6) = 0.03130928168234228;
      finalStiffnessExpected(0,4,6) = -0.19409897985233932;
      finalStiffnessExpected(0,5,6) = 0.646516807394903;
      finalStiffnessExpected(0,6,6) = 2.768471070769939;
      finalStiffnessExpected(0,7,6) = 0.3930390818199434;
      finalStiffnessExpected(0,8,6) = -0.20554311534889946;
      finalStiffnessExpected(0,9,6) = 0.2662828291668076;
      finalStiffnessExpected(0,10,6) = -0.042658120232853175;
      finalStiffnessExpected(0,11,6) = -0.018081593585049432;
      finalStiffnessExpected(0,12,6) = -0.10516353656798433;
      finalStiffnessExpected(0,13,6) = -1.0654413553140336;
      finalStiffnessExpected(0,14,6) = -0.1948086196250038;
      finalStiffnessExpected(0,15,6) = 0.0952355313745717;
      finalStiffnessExpected(0,0,7) = 0.012083901270027115;
      finalStiffnessExpected(0,1,7) = -0.009297475974199366;
      finalStiffnessExpected(0,2,7) = -0.018081593585049002;
      finalStiffnessExpected(0,3,7) = 0.01529516828922188;
      finalStiffnessExpected(0,4,7) = 0.07624725856203408;
      finalStiffnessExpected(0,5,7) = -0.19409897985233965;
      finalStiffnessExpected(0,6,7) = 0.39303908181994346;
      finalStiffnessExpected(0,7,7) = 0.44759823549685007;
      finalStiffnessExpected(0,8,7) = 0.15893866537733525;
      finalStiffnessExpected(0,9,7) = -0.20554311534889994;
      finalStiffnessExpected(0,10,7) = 0.031309281682341365;
      finalStiffnessExpected(0,11,7) = 0.015295168289222456;
      finalStiffnessExpected(0,12,7) = -0.2034111921699253;
      finalStiffnessExpected(0,13,7) = -0.10516353656798313;
      finalStiffnessExpected(0,14,7) = 0.09523553137457234;
      finalStiffnessExpected(0,15,7) = -0.04069639866315229;
      finalStiffnessExpected(0,0,8) = -0.04069639866315294;
      finalStiffnessExpected(0,1,8) = 0.09523553137457202;
      finalStiffnessExpected(0,2,8) = -0.10516353656798257;
      finalStiffnessExpected(0,3,8) = -0.20341119216992584;
      finalStiffnessExpected(0,4,8) = 0.015295168289221797;
      finalStiffnessExpected(0,5,8) = 0.03130928168234158;
      finalStiffnessExpected(0,6,8) = -0.2055431153488995;
      finalStiffnessExpected(0,7,8) = 0.15893866537733528;
      finalStiffnessExpected(0,8,8) = 0.44759823549685;
      finalStiffnessExpected(0,9,8) = 0.39303908181994224;
      finalStiffnessExpected(0,10,8) = -0.19409897985233915;
      finalStiffnessExpected(0,11,8) = 0.076247258562035;
      finalStiffnessExpected(0,12,8) = 0.01529516828922222;
      finalStiffnessExpected(0,13,8) = -0.018081593585050057;
      finalStiffnessExpected(0,14,8) = -0.009297475974200078;
      finalStiffnessExpected(0,15,8) = 0.01208390127002708;
      finalStiffnessExpected(0,0,9) = 0.0952355313745713;
      finalStiffnessExpected(0,1,9) = -0.19480861962500412;
      finalStiffnessExpected(0,2,9) = -1.065441355314035;
      finalStiffnessExpected(0,3,9) = -0.10516353656798255;
      finalStiffnessExpected(0,4,9) = -0.018081593585049044;
      finalStiffnessExpected(0,5,9) = -0.04265812023285795;
      finalStiffnessExpected(0,6,9) = 0.2662828291668075;
      finalStiffnessExpected(0,7,9) = -0.20554311534890002;
      finalStiffnessExpected(0,8,9) = 0.3930390818199423;
      finalStiffnessExpected(0,9,9) = 2.768471070769944;
      finalStiffnessExpected(0,10,9) = 0.6465168073949105;
      finalStiffnessExpected(0,11,9) = -0.1940989798523388;
      finalStiffnessExpected(0,12,9) = 0.03130928168234099;
      finalStiffnessExpected(0,13,9) = -0.04265812023285935;
      finalStiffnessExpected(0,14,9) = 0.02064631452471847;
      finalStiffnessExpected(0,15,9) = -0.009297475974200194;
      finalStiffnessExpected(0,0,10) = -0.10516353656798393;
      finalStiffnessExpected(0,1,10) = -1.0654413553140385;
      finalStiffnessExpected(0,2,10) = -0.19480861962500462;
      finalStiffnessExpected(0,3,10) = 0.0952355313745718;
      finalStiffnessExpected(0,4,10) = -0.009297475974200047;
      finalStiffnessExpected(0,5,10) = 0.020646314524717515;
      finalStiffnessExpected(0,6,10) = -0.042658120232853196;
      finalStiffnessExpected(0,7,10) = 0.03130928168234133;
      finalStiffnessExpected(0,8,10) = -0.19409897985233915;
      finalStiffnessExpected(0,9,10) = 0.6465168073949105;
      finalStiffnessExpected(0,10,10) = 2.7684710707699494;
      finalStiffnessExpected(0,11,10) = 0.3930390818199453;
      finalStiffnessExpected(0,12,10) = -0.20554311534890002;
      finalStiffnessExpected(0,13,10) = 0.26628282916680523;
      finalStiffnessExpected(0,14,10) = -0.0426581202328601;
      finalStiffnessExpected(0,15,10) = -0.0180815935850497;
      finalStiffnessExpected(0,0,11) = -0.20341119216992581;
      finalStiffnessExpected(0,1,11) = -0.10516353656798388;
      finalStiffnessExpected(0,2,11) = 0.09523553137457128;
      finalStiffnessExpected(0,3,11) = -0.040696398663152805;
      finalStiffnessExpected(0,4,11) = 0.01208390127002714;
      finalStiffnessExpected(0,5,11) = -0.009297475974201004;
      finalStiffnessExpected(0,6,11) = -0.01808159358504943;
      finalStiffnessExpected(0,7,11) = 0.015295168289222463;
      finalStiffnessExpected(0,8,11) = 0.07624725856203499;
      finalStiffnessExpected(0,9,11) = -0.1940989798523388;
      finalStiffnessExpected(0,10,11) = 0.39303908181994535;
      finalStiffnessExpected(0,11,11) = 0.44759823549685124;
      finalStiffnessExpected(0,12,11) = 0.1589386653773352;
      finalStiffnessExpected(0,13,11) = -0.20554311534889882;
      finalStiffnessExpected(0,14,11) = 0.03130928168234182;
      finalStiffnessExpected(0,15,11) = 0.015295168289222092;
      finalStiffnessExpected(0,0,12) = 0.015295168289222292;
      finalStiffnessExpected(0,1,12) = -0.01808159358504828;
      finalStiffnessExpected(0,2,12) = -0.009297475974199231;
      finalStiffnessExpected(0,3,12) = 0.01208390127002751;
      finalStiffnessExpected(0,4,12) = -0.040696398663152195;
      finalStiffnessExpected(0,5,12) = 0.09523553137457193;
      finalStiffnessExpected(0,6,12) = -0.10516353656798431;
      finalStiffnessExpected(0,7,12) = -0.20341119216992526;
      finalStiffnessExpected(0,8,12) = 0.015295168289222207;
      finalStiffnessExpected(0,9,12) = 0.03130928168234099;
      finalStiffnessExpected(0,10,12) = -0.20554311534889985;
      finalStiffnessExpected(0,11,12) = 0.1589386653773353;
      finalStiffnessExpected(0,12,12) = 0.44759823549684974;
      finalStiffnessExpected(0,13,12) = 0.3930390818199431;
      finalStiffnessExpected(0,14,12) = -0.1940989798523389;
      finalStiffnessExpected(0,15,12) = 0.07624725856203424;
      finalStiffnessExpected(0,0,13) = 0.03130928168234124;
      finalStiffnessExpected(0,1,13) = -0.04265812023285961;
      finalStiffnessExpected(0,2,13) = 0.020646314524718382;
      finalStiffnessExpected(0,3,13) = -0.009297475974198725;
      finalStiffnessExpected(0,4,13) = 0.09523553137457219;
      finalStiffnessExpected(0,5,13) = -0.194808619625001;
      finalStiffnessExpected(0,6,13) = -1.0654413553140334;
      finalStiffnessExpected(0,7,13) = -0.10516353656798307;
      finalStiffnessExpected(0,8,13) = -0.018081593585050043;
      finalStiffnessExpected(0,9,13) = -0.04265812023285938;
      finalStiffnessExpected(0,10,13) = 0.2662828291668053;
      finalStiffnessExpected(0,11,13) = -0.20554311534889877;
      finalStiffnessExpected(0,12,13) = 0.39303908181994307;
      finalStiffnessExpected(0,13,13) = 2.768471070769935;
      finalStiffnessExpected(0,14,13) = 0.6465168073949052;
      finalStiffnessExpected(0,15,13) = -0.19409897985233895;
      finalStiffnessExpected(0,0,14) = -0.20554311534889988;
      finalStiffnessExpected(0,1,14) = 0.2662828291668068;
      finalStiffnessExpected(0,2,14) = -0.04265812023286065;
      finalStiffnessExpected(0,3,14) = -0.018081593585049075;
      finalStiffnessExpected(0,4,14) = -0.10516353656798508;
      finalStiffnessExpected(0,5,14) = -1.0654413553140447;
      finalStiffnessExpected(0,6,14) = -0.19480861962500384;
      finalStiffnessExpected(0,7,14) = 0.09523553137457234;
      finalStiffnessExpected(0,8,14) = -0.009297475974200074;
      finalStiffnessExpected(0,9,14) = 0.020646314524718386;
      finalStiffnessExpected(0,10,14) = -0.042658120232860156;
      finalStiffnessExpected(0,11,14) = 0.031309281682341886;
      finalStiffnessExpected(0,12,14) = -0.19409897985233893;
      finalStiffnessExpected(0,13,14) = 0.6465168073949051;
      finalStiffnessExpected(0,14,14) = 2.7684710707699507;
      finalStiffnessExpected(0,15,14) = 0.39303908181994524;
      finalStiffnessExpected(0,0,15) = 0.15893866537733517;
      finalStiffnessExpected(0,1,15) = -0.20554311534889805;
      finalStiffnessExpected(0,2,15) = 0.031309281682341386;
      finalStiffnessExpected(0,3,15) = 0.015295168289222102;
      finalStiffnessExpected(0,4,15) = -0.20341119216992595;
      finalStiffnessExpected(0,5,15) = -0.10516353656798569;
      finalStiffnessExpected(0,6,15) = 0.09523553137457172;
      finalStiffnessExpected(0,7,15) = -0.04069639866315229;
      finalStiffnessExpected(0,8,15) = 0.012083901270027071;
      finalStiffnessExpected(0,9,15) = -0.009297475974200178;
      finalStiffnessExpected(0,10,15) = -0.018081593585049675;
      finalStiffnessExpected(0,11,15) = 0.015295168289222094;
      finalStiffnessExpected(0,12,15) = 0.07624725856203424;
      finalStiffnessExpected(0,13,15) = -0.194098979852339;
      finalStiffnessExpected(0,14,15) = 0.39303908181994546;
      finalStiffnessExpected(0,15,15) = 0.44759823549685024;
    } else {
      finalStiffnessExpected.resize(1,12,12);
      finalStiffnessExpected(0,0,0) = 1.2130738017483724;
      finalStiffnessExpected(0,0,1) = 0.1874959664710494;
      finalStiffnessExpected(0,0,2) = -0.16278969816999733;
      finalStiffnessExpected(0,0,3) = -0.0965735970294468;
      finalStiffnessExpected(0,0,4) = -0.12324513015303423;
      finalStiffnessExpected(0,0,5) = 0.08593805540037204;
      finalStiffnessExpected(0,0,6) = -0.05722499478625101;
      finalStiffnessExpected(0,0,7) = 0.08593805540037114;
      finalStiffnessExpected(0,0,8) = -0.12324513015303368;
      finalStiffnessExpected(0,0,9) = -0.09657359702944728;
      finalStiffnessExpected(0,0,10) = -0.1627896981699978;
      finalStiffnessExpected(0,0,11) = 0.18749596647104538;
      finalStiffnessExpected(0,1,0) = 0.1874959664710492;
      finalStiffnessExpected(0,1,1) = 2.768471070769949;
      finalStiffnessExpected(0,1,2) = 0.6465168073949071;
      finalStiffnessExpected(0,1,3) = -0.16278969816999803;
      finalStiffnessExpected(0,1,4) = -0.04265812023285908;
      finalStiffnessExpected(0,1,5) = 0.02064631452471699;
      finalStiffnessExpected(0,1,6) = 0.08593805540037269;
      finalStiffnessExpected(0,1,7) = -0.19480861962500412;
      finalStiffnessExpected(0,1,8) = -1.0654413553140385;
      finalStiffnessExpected(0,1,9) = -0.12324513015303211;
      finalStiffnessExpected(0,1,10) = -0.04265812023285966;
      finalStiffnessExpected(0,1,11) = 0.26628282916680657;
      finalStiffnessExpected(0,2,0) = -0.16278969816999736;
      finalStiffnessExpected(0,2,1) = 0.6465168073949071;
      finalStiffnessExpected(0,2,2) = 2.768471070769943;
      finalStiffnessExpected(0,2,3) = 0.18749596647104438;
      finalStiffnessExpected(0,2,4) = 0.26628282916680907;
      finalStiffnessExpected(0,2,5) = -0.04265812023285687;
      finalStiffnessExpected(0,2,6) = -0.1232451301530316;
      finalStiffnessExpected(0,2,7) = -1.0654413553140347;
      finalStiffnessExpected(0,2,8) = -0.19480861962500462;
      finalStiffnessExpected(0,2,9) = 0.08593805540037207;
      finalStiffnessExpected(0,2,10) = 0.020646314524718386;
      finalStiffnessExpected(0,2,11) = -0.04265812023286083;
      finalStiffnessExpected(0,3,0) = -0.09657359702944679;
      finalStiffnessExpected(0,3,1) = -0.162789698169998;
      finalStiffnessExpected(0,3,2) = 0.18749596647104438;
      finalStiffnessExpected(0,3,3) = 1.2130738017483749;
      finalStiffnessExpected(0,3,4) = 0.18749596647105018;
      finalStiffnessExpected(0,3,5) = -0.16278969816999708;
      finalStiffnessExpected(0,3,6) = -0.09657359702944818;
      finalStiffnessExpected(0,3,7) = -0.1232451301530316;
      finalStiffnessExpected(0,3,8) = 0.08593805540037176;
      finalStiffnessExpected(0,3,9) = -0.05722499478625035;
      finalStiffnessExpected(0,3,10) = 0.0859380554003735;
      finalStiffnessExpected(0,3,11) = -0.1232451301530342;
      finalStiffnessExpected(0,4,0) = -0.12324513015303415;
      finalStiffnessExpected(0,4,1) = -0.04265812023285916;
      finalStiffnessExpected(0,4,2) = 0.2662828291668091;
      finalStiffnessExpected(0,4,3) = 0.18749596647105013;
      finalStiffnessExpected(0,4,4) = 2.7684710707699525;
      finalStiffnessExpected(0,4,5) = 0.6465168073949028;
      finalStiffnessExpected(0,4,6) = -0.16278969816999805;
      finalStiffnessExpected(0,4,7) = -0.04265812023285785;
      finalStiffnessExpected(0,4,8) = 0.02064631452471759;
      finalStiffnessExpected(0,4,9) = 0.08593805540037094;
      finalStiffnessExpected(0,4,10) = -0.19480861962500096;
      finalStiffnessExpected(0,4,11) = -1.065441355314045;
      finalStiffnessExpected(0,5,0) = 0.08593805540037205;
      finalStiffnessExpected(0,5,1) = 0.02064631452471697;
      finalStiffnessExpected(0,5,2) = -0.04265812023285686;
      finalStiffnessExpected(0,5,3) = -0.16278969816999705;
      finalStiffnessExpected(0,5,4) = 0.646516807394903;
      finalStiffnessExpected(0,5,5) = 2.768471070769939;
      finalStiffnessExpected(0,5,6) = 0.18749596647104394;
      finalStiffnessExpected(0,5,7) = 0.2662828291668076;
      finalStiffnessExpected(0,5,8) = -0.042658120232853015;
      finalStiffnessExpected(0,5,9) = -0.12324513015303372;
      finalStiffnessExpected(0,5,10) = -1.0654413553140336;
      finalStiffnessExpected(0,5,11) = -0.19480861962500387;
      finalStiffnessExpected(0,6,0) = -0.05722499478625102;
      finalStiffnessExpected(0,6,1) = 0.08593805540037266;
      finalStiffnessExpected(0,6,2) = -0.12324513015303164;
      finalStiffnessExpected(0,6,3) = -0.09657359702944819;
      finalStiffnessExpected(0,6,4) = -0.16278969816999805;
      finalStiffnessExpected(0,6,5) = 0.18749596647104402;
      finalStiffnessExpected(0,6,6) = 1.2130738017483707;
      finalStiffnessExpected(0,6,7) = 0.18749596647104227;
      finalStiffnessExpected(0,6,8) = -0.1627896981699979;
      finalStiffnessExpected(0,6,9) = -0.09657359702944562;
      finalStiffnessExpected(0,6,10) = -0.12324513015303319;
      finalStiffnessExpected(0,6,11) = 0.08593805540037228;
      finalStiffnessExpected(0,7,0) = 0.08593805540037114;
      finalStiffnessExpected(0,7,1) = -0.19480861962500412;
      finalStiffnessExpected(0,7,2) = -1.065441355314035;
      finalStiffnessExpected(0,7,3) = -0.12324513015303161;
      finalStiffnessExpected(0,7,4) = -0.04265812023285795;
      finalStiffnessExpected(0,7,5) = 0.2662828291668075;
      finalStiffnessExpected(0,7,6) = 0.18749596647104216;
      finalStiffnessExpected(0,7,7) = 2.768471070769944;
      finalStiffnessExpected(0,7,8) = 0.6465168073949105;
      finalStiffnessExpected(0,7,9) = -0.16278969816999775;
      finalStiffnessExpected(0,7,10) = -0.042658120232859344;
      finalStiffnessExpected(0,7,11) = 0.02064631452471851;
      finalStiffnessExpected(0,8,0) = -0.12324513015303362;
      finalStiffnessExpected(0,8,1) = -1.0654413553140385;
      finalStiffnessExpected(0,8,2) = -0.19480861962500462;
      finalStiffnessExpected(0,8,3) = 0.08593805540037175;
      finalStiffnessExpected(0,8,4) = 0.02064631452471758;
      finalStiffnessExpected(0,8,5) = -0.04265812023285309;
      finalStiffnessExpected(0,8,6) = -0.16278969816999786;
      finalStiffnessExpected(0,8,7) = 0.6465168073949105;
      finalStiffnessExpected(0,8,8) = 2.768471070769949;
      finalStiffnessExpected(0,8,9) = 0.18749596647104536;
      finalStiffnessExpected(0,8,10) = 0.26628282916680507;
      finalStiffnessExpected(0,8,11) = -0.04265812023286016;
      finalStiffnessExpected(0,9,0) = -0.09657359702944726;
      finalStiffnessExpected(0,9,1) = -0.12324513015303219;
      finalStiffnessExpected(0,9,2) = 0.08593805540037208;
      finalStiffnessExpected(0,9,3) = -0.05722499478625036;
      finalStiffnessExpected(0,9,4) = 0.08593805540037092;
      finalStiffnessExpected(0,9,5) = -0.12324513015303373;
      finalStiffnessExpected(0,9,6) = -0.09657359702944565;
      finalStiffnessExpected(0,9,7) = -0.1627896981699978;
      finalStiffnessExpected(0,9,8) = 0.18749596647104533;
      finalStiffnessExpected(0,9,9) = 1.2130738017483718;
      finalStiffnessExpected(0,9,10) = 0.18749596647104444;
      finalStiffnessExpected(0,9,11) = -0.16278969816999714;
      finalStiffnessExpected(0,10,0) = -0.16278969816999775;
      finalStiffnessExpected(0,10,1) = -0.04265812023285955;
      finalStiffnessExpected(0,10,2) = 0.020646314524718348;
      finalStiffnessExpected(0,10,3) = 0.08593805540037351;
      finalStiffnessExpected(0,10,4) = -0.19480861962500098;
      finalStiffnessExpected(0,10,5) = -1.0654413553140334;
      finalStiffnessExpected(0,10,6) = -0.12324513015303314;
      finalStiffnessExpected(0,10,7) = -0.04265812023285932;
      finalStiffnessExpected(0,10,8) = 0.26628282916680507;
      finalStiffnessExpected(0,10,9) = 0.1874959664710443;
      finalStiffnessExpected(0,10,10) = 2.768471070769935;
      finalStiffnessExpected(0,10,11) = 0.6465168073949051;
      finalStiffnessExpected(0,11,0) = 0.18749596647104533;
      finalStiffnessExpected(0,11,1) = 0.2662828291668066;
      finalStiffnessExpected(0,11,2) = -0.0426581202328609;
      finalStiffnessExpected(0,11,3) = -0.12324513015303429;
      finalStiffnessExpected(0,11,4) = -1.0654413553140452;
      finalStiffnessExpected(0,11,5) = -0.19480861962500387;
      finalStiffnessExpected(0,11,6) = 0.0859380554003723;
      finalStiffnessExpected(0,11,7) = 0.02064631452471848;
      finalStiffnessExpected(0,11,8) = -0.04265812023286017;
      finalStiffnessExpected(0,11,9) = -0.16278969816999722;
      finalStiffnessExpected(0,11,10) = 0.6465168073949052;
      finalStiffnessExpected(0,11,11) = 2.768471070769951;    }
  }
};

const string & TestBilinearFormAnalyticBoundaryIntegral::S_TEST  = "test";
const string & TestBilinearFormAnalyticBoundaryIntegral::S_TRIAL = "trace";

#endif
